/*! ht-solutions - v1.0.0 - 2016-01-09
* http://www.highstreet-technologies.com
* Copyright (c) 2016 highstreet technologies GmbH; Licensed Apache-2.0 */
!function(){"use strict";function a(){for(var a=0;a<arguments.length;++a)this[arguments[a]]=a;return this}var b=angular.module("alert",[]);b.factory("alertService",function(){var b={};b.id=new a("PROCESSING","SUCCESS","FAILED","WARNING"),b.isWorking=[!0,!1,!1],b.type=["warning","success","danger","warning"],b.message=["CALCULATING","CALCULATION_OK","CALCULATION_FAILED","WARNING"];var c=function(a){return{isWorking:b.isWorking[a],type:b.type[a],message:b.message[a]}},d={};return d.setMessage=function(a){b.message=a},d.processing=function(){return c(b.id.PROCESSING)},d.success=function(){return c(b.id.SUCCESS)},d.warning=function(){return c(b.id.WARNING)},d.failed=function(a){return c(b.id.FAILED)},d.clear=function(){return{}},d})}(),function(){"use strict";var a=angular.module("translate",["pascalprecht.translate"]);a.config(["$translateProvider",function(a){a.useStaticFilesLoader({prefix:"/modules/languages/lang-",suffix:".json"}),a.fallbackLanguage("en_US"),a.preferredLanguage("en_US"),a.useSanitizeValueStrategy("escaped")}]),a.factory("translateService",["$translate",function(a){var b={};return b.org=a,b.en_US={sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sInfoThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sZeroRecords:"No matching records found",oPaginate:{sFirst:"<span title='Show first entry' class='glyphicon glyphicon-fast-backward'></span>",sPrevious:"<span title='Show previous entries' class='glyphicon glyphicon-step-backward'></span>",sNext:"<span title='Show next entries' class='glyphicon glyphicon-step-forward'></span>",sLast:"<span title='Show last entry' class='glyphicon glyphicon-fast-forward'></span>"},oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"}},b.de_DE={sEmptyTable:"Keine Daten in der Tabelle vorhanden",sInfo:"_START_ bis _END_ von _TOTAL_ Einträgen",sInfoEmpty:"0 bis 0 von 0 Einträgen",sInfoFiltered:"(gefiltert von _MAX_ Einträgen)",sInfoPostFix:"",sInfoThousands:".",sLengthMenu:"_MENU_ Einträge anzeigen",sLoadingRecords:"Wird geladen...",sProcessing:"Bitte warten...",sSearch:"Suchen",sZeroRecords:"Keine Einträge vorhanden.",oPaginate:{sFirst:"<span title='Show first entry' class='glyphicon glyphicon-fast-backward'></span>",sPrevious:"<span title='Show previous entries' class='glyphicon glyphicon-step-backward'></span>",sNext:"<span title='Show next entries' class='glyphicon glyphicon-step-forward'></span>",sLast:"<span title='Show last entry' class='glyphicon glyphicon-fast-forward'></span>"},oAria:{sSortAscending:": aktivieren, um Spalte aufsteigend zu sortieren",sSortDescending:": aktivieren, um Spalte absteigend zu sortieren"}},b.es_ES={sProcessing:"Procesando...",sLengthMenu:"Mostrar _MENU_ registros",sZeroRecords:"No se encontraron resultados",sEmptyTable:"Ningan dato disponible en esta tabla",sInfo:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",sInfoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",sInfoFiltered:"(filtrado de un total de _MAX_ registros)",sInfoPostFix:"",sSearch:"Buscar:",sUrl:"",sInfoThousands:",",sLoadingRecords:"Cargando...",oPaginate:{sFirst:"<span title='Show first entry' class='glyphicon glyphicon-fast-backward'></span>",sPrevious:"<span title='Show previous entries' class='glyphicon glyphicon-step-backward'></span>",sNFext:"<span title='Show next entries' class='glyphicon glyphicon-step-forward'></span>",sLast:"<span title='Show last entry' class='glyphicon glyphicon-fast-forward'></span>"},oAria:{sSortAscending:": Activar para ordenar la columna de manera ascendente",sSortDescending:": Activar para ordenar la columna de manera descendente"}},b.changeLanguage=function(c,d){a.use(c),void 0!==d&&null!==d&&d.withOption("language",b[c])},b}])}();var app=angular.module("htLogin",["ui.bootstrap","base64","alert","translate"]);app.controller("htLoginCtrl",["$scope","$window","$location","authenticationService","alertService","translateService",function(a,b,c,d,e,f){"use strict";window.name="htSolutions",e.setMessage(["LOADING","SUCCESS","FAILED"]),a.changeLanguage=f.changeLanguage,a.login={},a.login.username="",a.login.password="",a.remember=!1,a.isWorking=!1,d.logout(function(){a.isWorking=!1}),a.success=function(c){d.isAuthenticated()?b.location.href="/ux/#/":(console.info("Must not happen! Code 124"),b.location.href="/#/login"),a.isWorking=!1},a.error=function(b){a.message="LOGIN_FAILURE",a.isWorking=!1},a.sendLogin=function(){a.isWorking=!0,d.login(a.login.email,a.login.password,a.success,a.error)}}]),app.factory("authenticationService",["$http","$base64","$cookies",function(a,b,c){"use strict";var d=function(a,b){return{method:"POST",url:"/auth/login",headers:{"Content-Type":"application/json"},data:{username:a,password:b}}},e="ht_session_auth_token",f="ht_profile",g={};return g.getUsername=function(a){return b.decode(a)},g.init=function(b){a.defaults.headers.common["X-Access-Token"]=b||c.token},g.isAuthenticated=function(){return c.get(e).indexOf("Bearer ")>-1},g.getProfileName=function(){return c.get(f)},g.login=function(h,i,j,k){var l=d(h,i);a(l).success(function(d,g,i,k){a.defaults.headers.common.Authorization="Bearer "+d.token,a.defaults.headers.common.Accept="application/json, text/javascript",a.defaults.headers.common["Content-Type"]="application/json; charset=utf-8",c.put(e,"Bearer "+d.token,{path:"/"}),c.put(f,b.encode(h),{path:"/"}),j(d)}).error(function(a){g.deleteToken(),k(a)})},g.logout=function(a){g.deleteToken(),a()},g.deleteToken=function(){null!==a.defaults.headers.common.Authorization&&delete a.defaults.headers.common.Authorization,c.remove(e),c.remove(f)},g}]),String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return"undefined"!=typeof a[c]?a[c]:b})}),angular.module("htQueryService",[]).factory("$query",["$rootScope","$http",function(a,b){"use strict";var c=["nominatim","database","site","sitelink","mwrlinkrevisionvariant","path"],d={};d.nominatim=null,d.database=function(a){return{query:{filtered:{query:{match_all:{}},filter:{or:[{term:{"site.id.siteId":a.toLowerCase()}},{term:{"site.siteName":a.toLowerCase()}},{term:{"sitelink.name":a}},{and:[{term:{"sitelink.id.high":a.toLowerCase().split("-")[0]}},{term:{"sitelink.id.low":a.toLowerCase().split("-")[1]||""}}]},{term:{"mwrlinkrevisionvariant.id.mwrLinkId":a}}]}}}}},d.site=function(a){return{query:{filtered:{query:{match_all:{}},filter:{or:[{term:{"site.id.siteId":a.toLowerCase()}},{term:{"site.siteName":a.toLowerCase()}}]}}}}},d.sitelink=function(a){return{query:{filtered:{query:{match_all:{}},filter:{or:[{term:{"sitelink.name":a}},{and:[{term:{"sitelink.id.high":a.split("-")[0].toLowerCase()}},{term:{"sitelink.id.low":a.split("-")[1].toLowerCase()}}]}]}}}}},d.mwrlinkrevisionvariant=function(a){return{query:{filtered:{query:{match_all:{}},filter:{or:[{term:{"mwrlinkrevisionvariant.id.mwrLinkId":a}}]}}}}},d.path=function(a){return{query:{filtered:{query:{match_all:{}},filter:{and:[{terms:{id:a}}]}}}}};var e=function(a,b){var e=c.indexOf(a);return d[c[e]](b)},f={},g=function(a,b){var d={},e=c.indexOf(a.request.objectType);return-1===e?(d.status="Error",d.message="Query of "+a.request.objectType+" is not supported.",d.data=void 0,b(d)):(0===e&&i(a.request.values,function(a,c){return d.status="OK",d.message="Answer of OSM received.",d.data=c,b(d)}),void(e>0&&h(a,function(a,c){return a?(d.status="Error",d.message=a,d.data=c,b(d)):(d.status="OK",d.message="Answer of database received.",d.data=c,b(d))})))},h=function(a,c){var d={method:"POST",url:["/db",a.request.dbIndex,a.request.objectType,"_search"].join("/"),data:e(a.request.objectType,a.request.value)};"database"===a.request.objectType&&(d.url=["/db",a.request.dbIndex,"_search"].join("/")),b(d).success(function(a,b){return c(null,a)}).error(function(a,b){return c(b,null)})},i=function(a,c){var d="https://nominatim.openstreetmap.org/search?q={0}&countrycodes=de,br&format=json&polygon_geojson=0&limit=1",e=d.format(a);b.get(e).success(function(a,b){return c(null,a)}).error(function(a,b){return c(b,null)})},j={};return j.name="Query service",j.queryResultNotification=function(b,c){a.$broadcast(b,c)},j.queryResultListener=function(b){a.$on("query",b)},j.query=function(a,b){f.request=a,g(f,function(a){return f.result=a,b(f)})},j}]);var htDatabase=angular.module("htDatabase",[]);htDatabase.config(["$stateProvider",function(a){"use strict";a.state("database",{url:"/database/:dbIndex",templateUrl:"modules/database/database.html",controller:["$rootScope","$scope","$stateParams","$database","alertService","$header","$uibModal",function(a,b,c,d,e,f,g){b.dbIndex=c.dbIndex,a.title="htDatabase",e.setMessage(["LOADING","SUCCESS","FAILED"]),f.setStatus(e.processing());var h=1e3,i={},j={string:"string","boolean":"boolean",integer:"number","long":"number","float":"number","double":"number","null":"string",undefined:"object"},k=function(a,c,d){var e=j[c.type],f={field:a,type:e,minWidth:80,headerCellClass:b.highlightFilteredHeader};return"number"===e&&(f.cellClass="number"),"object"===e&&(f.cellTemplate='<div ng-click="grid.appScope.show(row.entity[col.field], col.field)" title="{{ COL_FIELD }}" class="ui-grid-cell-contents pointer cellTooltip">{{ COL_FIELD }}</div>'),a.startsWith("id")&&(f.pinnedLeft=!0),d(f)};b.show=function(a,c){b.selectedCell=a,b.field=c;var d=g.open({animation:b.animationsEnabled,templateUrl:"/ux/modules/database/database.info.html",controller:"ObjectInfoCtrl",size:"lg",resolve:{selectedCell:function(){return b.selectedCell},field:function(){return b.field}}});d.result.then(function(a,b){},function(){})};var l=function(a,b){var c=[],d=Object.keys(i[a].properties);return d.map(function(b){k(b,i[a].properties[b],function(a){c.push(a)})}),b(c)},m={},n=function(a){a.hits.hits.map(function(a){b.gridOptions.data.push(a._source)}),b.gridOptions.data.length>=m.count&&f.setStatus(e.success())},o=function(){if(this.key!==m.key){m=this,f.setStatus(e.processing()),l(this.key,function(a){b.gridOptions.columnDefs=a}),b.gridOptions.data=[];for(var a=0;a<=this.count;){f.setStatus(e.processing());var c,g;d.getData(b.dbIndex,this,h,a,c,g,n),a+=h}}};b.docTypes=[],d.getMappings(b.dbIndex,function(a,c){if(a)console.info(a);else{i=c;var e=Object.keys(c),f=[];d.count(b.dbIndex,e,function(a){a.terms.map(function(a){f.push({key:a.term,label:a.term.toUpperCase(),count:a.count,getContent:o})});var c=f.length-1;f[c].active=!0,b.docTypes=f.sort(function(a,b){return b.count-a.count})})}}),b.gridOptions={data:[],enableSorting:!0,enableColumnResizing:!0,enableFiltering:!0,enableGridMenu:!0,showGridFooter:!0,showColumnFooter:!0,fastWatch:!1,enableRowSelection:!0,enableRowHeaderSelection:!0,multiSelect:!1,columnDefs:b.columns,onRegisterApi:function(a){b.gridApi=a}},b.gridOptions.gridMenuCustomItems=[{title:"Rotate Grid",action:function(a){this.grid.element.toggleClass("rotated")},order:210}]}]})}]),htDatabase.controller("ObjectInfoCtrl",["$scope","$uibModalInstance","selectedCell","field",function(a,b,c,d){a.selectedCell=c,a.field=d,a.cancel=function(){b.dismiss("cancel")}}]);var htBsConnections=angular.module("htBsConnections",["ngTouch","ui.bootstrap","ui.grid","ui.grid.pagination","ui.grid.exporter","ui.grid.moveColumns","ui.grid.pinning","ui.grid.selection","ui.grid.resizeColumns","htLogin","htDatabase","alert","translate"]);htBsConnections.config(["$stateProvider",function(a){"use strict";a.state("bsConnections",{url:"/bsConnections/:dbIndex",templateUrl:"/ux/modules/bsConnections/bsConnections.html",controller:["$rootScope","$scope","$stateParams","uiGridConstants","$bsConnections","$header","alertService",function(a,b,c,d,e,f,g){b.dbIndex=c.dbIndex,a.title="htBsConnections",g.setMessage(["LOADING","SUCCESS","FAILED"]);var h=['<div class="ui-grid-cell-contents">',"<span>{{row.entity[col.field]}} </span>",'<a class="vCenter text-right" >','<span title="{{grid.appScope.getTitle( COL_FIELD , 2)}}" ng-click="grid.appScope.open(row.entity[col.field])" class="pointer glyphicon glyphicon-info-sign"></span>',"<span> </span>",'<span title="{{grid.appScope.getTitle( COL_FIELD , 1)}}" ng-click="grid.appScope.show(row.entity[col.field])" class="pointer glyphicon glyphicon-map-marker"></span>',"</a>","</div>"].join(""),i=['<div class="ui-grid-cell-contents">',"<span>{{COL_FIELD}} </span>",'<a class="vCenter text-right" >','<span title="Show details of network element: {{COL_FIELD}}" ng-click="grid.appScope.showNetworkElement(row.entity[col.field])" class="pointer glyphicon glyphicon-info-sign"></span>',"</a>","</div>"].join(""),j=['<div class="ui-grid-cell-contents">',"<span>{{COL_FIELD}} </span>",'<a class="vCenter text-right" >','<span title="Show details of site: {{COL_FIELD}}" ng-click="grid.appScope.showSite(row.entity[col.field])" class="pointer glyphicon glyphicon-info-sign"></span>',"</a>","</div>"].join("");b.highlightFilteredHeader=function(a,b,c){return c.filters[0].term?"header-filtered":""};var k=["Delete","Show in network map","Show details"];b.getTitle=function(a,b){var c=k[b]+": "+a;return c},b.show=function(a){var c="/ux/modules/networkMap/map.html#/"+b.dbIndex+"?path="+a;window.open(c,"htNetworkMap")},b.open=function(a){var c="/ux/#/paths/"+b.dbIndex+"/"+a;window.open(c,"htSolutions")},b.showNetworkElement=function(a){var c="/ux/#/networkElements/"+b.dbIndex+"/"+a;window.open(c,"htSolutions")},b.showSite=function(a){var c="/ux/#/sites/"+b.dbIndex+"/"+a;window.open(c,"htSolutions")};var l={direction:d.ASC,priority:1},m={ROUID:{order:"asc"}},n={bool:{must:[]}},o={pageNumber:1,pageSize:10,sort:[m],filter:n};b.gridOptions={},b.gridOptions.data=[],b.gridOptions.enableColumnResizing=!0,b.gridOptions.enableSorting=!0,b.gridOptions.enableFiltering=!0,b.gridOptions.enableGridMenu=!0,b.gridOptions.showGridFooter=!0,b.gridOptions.fastWatch=!0,b.gridOptions.enableRowSelection=!0,b.gridOptions.enableRowHeaderSelection=!0,b.gridOptions.multiSelect=!1,b.gridOptions.paginationPageSizes=[10,100,1e3],b.gridOptions.paginationPageSize=10,b.gridOptions.useExternalPagination=!0,b.gridOptions.useExternalSorting=!0,b.gridOptions.useExternalFiltering=!0,b.gridOptions.gridMenuCustomItems=[{title:"Rotate Grid",action:function(a){this.grid.element.toggleClass("rotated")},order:2100}],b.gridOptions.columnDefs=[{pinnedLeft:!0,sort:l,field:"ROUID",displayName:"ROUID",type:"string",width:"*",minWidth:140,maxWidth:255,cellTemplate:h,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"PATHTOCNAME",displayName:"PATHTOCNAME",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"SOURCE",displayName:"SOURCE",type:"string",width:"*",minWidth:80,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"PLANER",displayName:"PLANER",type:"string",width:"*",minWidth:100,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TODO29B",displayName:"TODO29B",type:"string",width:"*",minWidth:100,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ASSESSMENT18Y",displayName:"ASSESSMENT18Y",type:"string",width:"*",minWidth:100,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"QUALITY18B",displayName:"QUALITY18B",type:"string",width:"*",minWidth:100,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ASSESSMENT56Y",displayName:"ASSESSMENT56Y",type:"string",width:"*",minWidth:100,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"QUALITY56Y",displayName:"QUALITY56Y",type:"string",width:"*",minWidth:100,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"EQUIPPING",displayName:"EQUIPPING",type:"string",width:"*",minWidth:100,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"SITESTART",displayName:"SITESTART",type:"string",width:"*",minWidth:140,maxWidth:255,cellTemplate:j,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"SITESTARTPR",displayName:"SITESTARTPR",type:"string",width:"*",minWidth:160,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"SITESTARTEPlus",displayName:"SITESTARTEPlus",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NESTART",displayName:"NESTART",type:"string",width:"*",minWidth:140,maxWidth:255,cellTemplate:i,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NESTARTTYPE",displayName:"NESTARTTYPE",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NESTARTSTATUS",displayName:"NESTARTSTATUS",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NESTARTKAT",displayName:"NESTARTKAT",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NESTARTDUEDATE",displayName:"NESTARTDUEDATE",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NESTARTPRJNAME",displayName:"NESTARTPRJNAME",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NESTARTST29B",displayName:"NESTARTST29B",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NESTARTST18B",displayName:"NESTARTST18B",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NESTARTST56Y",displayName:"NESTARTST56Y",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NESTARTST56YCOMMENT",displayName:"NESTARTST56YCOMMENT",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NESTARTST90",displayName:"NESTARTST90",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NESTARTST156Y",displayName:"NESTARTST156Y",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NESTARTST156YCOMMENT",displayName:"NESTARTST156YCOMMENT",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NESTARTST190",displayName:"NESTARTST190",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"SITEEND",displayName:"SITEEND",type:"string",width:"*",minWidth:140,maxWidth:255,cellTemplate:j,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NEEND",displayName:"NEEND",type:"string",width:"*",minWidth:140,maxWidth:255,cellTemplate:i,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NEENDTYPE",displayName:"NEENDTYPE",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NEENDDUEDATE",displayName:"NEENDDUEDATE",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NEENDKAT",displayName:"NEENDKAT",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NEENDST62W",displayName:"NEENDST62W",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NEENDST90",displayName:"NEENDST90",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NEENDFT",displayName:"NEENDFT",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NEENDFTTYPE",displayName:"NEENDFTTYPE",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NEENDFTDUEDATE",displayName:"NEENDFTDUEDATE",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NEENDFTKAT",displayName:"NEENDFTKAT",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NEENDFTST76",displayName:"NEENDFTST76",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"NEENDFTST90",displayName:"NEENDFTST90",type:"string",width:"*",minWidth:120,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TYP",displayName:"TYP",type:"string",width:"*",minWidth:100,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"CAP",displayName:"CAP",type:"string",width:"*",minWidth:100,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"E1",displayName:"E1",type:"string",width:"*",minWidth:100,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LEN",displayName:"LEN",type:"string",width:"*",minWidth:60,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"SITEPATH",displayName:"SITEPATH",type:"string",width:"*",minWidth:300,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"USRLINK_01",displayName:"USRLINK_01",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKREV_01",displayName:"LINKREV_01",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKVAR_01",displayName:"LINKVAR_01",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"STATUS_01",displayName:"STATUS_01",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST82S_01",displayName:"ST82S_01",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST85S_01",displayName:"ST85S_01",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST90S_01",displayName:"ST90S_01",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST95S_01",displayName:"ST95S_01",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TDCN_01",displayName:"TDCN_01",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TODO_01",displayName:"TODO_01",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"USRLINK_02",displayName:"USRLINK_02",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKREV_02",displayName:"LINKREV_02",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKVAR_02",displayName:"LINKVAR_02",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"STATUS_02",displayName:"STATUS_02",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST82S_02",displayName:"ST82S_02",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST85S_02",displayName:"ST85S_02",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST90S_02",displayName:"ST90S_02",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST95S_02",displayName:"ST95S_02",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TDCN_02",displayName:"TDCN_02",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TODO_02",displayName:"TODO_02",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"USRLINK_03",displayName:"USRLINK_03",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKREV_03",displayName:"LINKREV_03",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKVAR_03",displayName:"LINKVAR_03",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"STATUS_03",displayName:"STATUS_03",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST82S_03",displayName:"ST82S_03",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST85S_03",displayName:"ST85S_03",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST90S_03",displayName:"ST90S_03",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST95S_03",displayName:"ST95S_03",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TDCN_03",displayName:"TDCN_03",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TODO_03",displayName:"TODO_03",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"USRLINK_04",displayName:"USRLINK_04",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKREV_04",displayName:"LINKREV_04",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKVAR_04",displayName:"LINKVAR_04",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"STATUS_04",displayName:"STATUS_04",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST82S_04",displayName:"ST82S_04",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST85S_04",displayName:"ST85S_04",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST90S_04",displayName:"ST90S_04",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST95S_04",displayName:"ST95S_04",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TDCN_04",displayName:"TDCN_04",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TODO_04",displayName:"TODO_04",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"USRLINK_05",displayName:"USRLINK_05",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKREV_05",displayName:"LINKREV_05",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKVAR_05",displayName:"LINKVAR_05",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"STATUS_05",displayName:"STATUS_05",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST82S_05",displayName:"ST82S_05",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST85S_05",displayName:"ST85S_05",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST90S_05",displayName:"ST90S_05",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST95S_05",displayName:"ST95S_05",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TDCN_05",displayName:"TDCN_05",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TODO_05",displayName:"TODO_05",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"USRLINK_06",displayName:"USRLINK_06",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKREV_06",displayName:"LINKREV_06",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKVAR_06",displayName:"LINKVAR_06",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"STATUS_06",displayName:"STATUS_06",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST82S_06",displayName:"ST82S_06",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST85S_06",displayName:"ST85S_06",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST90S_06",displayName:"ST90S_06",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST95S_06",displayName:"ST95S_06",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TDCN_06",displayName:"TDCN_06",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TODO_06",displayName:"TODO_06",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"USRLINK_07",displayName:"USRLINK_07",
type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKREV_07",displayName:"LINKREV_07",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKVAR_07",displayName:"LINKVAR_07",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"STATUS_07",displayName:"STATUS_07",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST82S_07",displayName:"ST82S_07",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST85S_07",displayName:"ST85S_07",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST90S_07",displayName:"ST90S_07",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST95S_07",displayName:"ST95S_07",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TDCN_07",displayName:"TDCN_07",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TODO_07",displayName:"TODO_07",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"USRLINK_08",displayName:"USRLINK_08",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKREV_08",displayName:"LINKREV_08",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKVAR_08",displayName:"LINKVAR_08",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"STATUS_08",displayName:"STATUS_08",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST82S_08",displayName:"ST82S_08",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST85S_08",displayName:"ST85S_08",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST90S_08",displayName:"ST90S_08",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST95S_08",displayName:"ST95S_08",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TDCN_08",displayName:"TDCN_08",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TODO_08",displayName:"TODO_08",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"USRLINK_09",displayName:"USRLINK_09",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKREV_09",displayName:"LINKREV_09",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKVAR_09",displayName:"LINKVAR_09",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"STATUS_09",displayName:"STATUS_09",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST82S_09",displayName:"ST82S_09",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST85S_09",displayName:"ST85S_09",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST90S_09",displayName:"ST90S_09",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST95S_09",displayName:"ST95S_09",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TDCN_09",displayName:"TDCN_09",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TODO_09",displayName:"TODO_09",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"USRLINK_10",displayName:"USRLINK_10",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKREV_10",displayName:"LINKREV_10",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKVAR_10",displayName:"LINKVAR_10",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"STATUS_10",displayName:"STATUS_10",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST82S_10",displayName:"ST82S_10",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST85S_10",displayName:"ST85S_10",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST90S_10",displayName:"ST90S_10",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST95S_10",displayName:"ST95S_10",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TDCN_10",displayName:"TDCN_10",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TODO_10",displayName:"TODO_10",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"USRLINK_11",displayName:"USRLINK_11",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKREV_11",displayName:"LINKREV_11",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKVAR_11",displayName:"LINKVAR_11",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"STATUS_11",displayName:"STATUS_11",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST82S_11",displayName:"ST82S_11",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST85S_11",displayName:"ST85S_11",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST90S_11",displayName:"ST90S_11",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST95S_11",displayName:"ST95S_11",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TDCN_11",displayName:"TDCN_11",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TODO_11",displayName:"TODO_11",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"USRLINK_12",displayName:"USRLINK_12",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKREV_12",displayName:"LINKREV_12",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKVAR_12",displayName:"LINKVAR_12",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"STATUS_12",displayName:"STATUS_12",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST82S_12",displayName:"ST82S_12",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST85S_12",displayName:"ST85S_12",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST90S_12",displayName:"ST90S_12",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST95S_12",displayName:"ST95S_12",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TDCN_12",displayName:"TDCN_12",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TODO_12",displayName:"TODO_12",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"USRLINK_13",displayName:"USRLINK_13",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKREV_13",displayName:"LINKREV_13",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKVAR_13",displayName:"LINKVAR_13",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"STATUS_13",displayName:"STATUS_13",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST82S_13",displayName:"ST82S_13",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST85S_13",displayName:"ST85S_13",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST90S_13",displayName:"ST90S_13",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST95S_13",displayName:"ST95S_13",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TDCN_13",displayName:"TDCN_13",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TODO_13",displayName:"TODO_13",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"USRLINK_14",displayName:"USRLINK_14",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKREV_14",displayName:"LINKREV_14",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"LINKVAR_14",displayName:"LINKVAR_14",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"STATUS_14",displayName:"STATUS_14",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST82S_14",displayName:"ST82S_14",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST85S_14",displayName:"ST85S_14",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST90S_14",displayName:"ST90S_14",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"ST95S_14",displayName:"ST95S_14",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TDCN_14",displayName:"TDCN_14",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader},{field:"TODO_14",displayName:"TODO_14",type:"string",width:"*",minWidth:200,maxWidth:255,headerCellFilter:"translate",headerCellClass:b.highlightFilteredHeader}],b.gridOptions.onRegisterApi=function(a){b.gridApi=a,b.gridApi.core.on.filterChanged(b,function(){var a=this.grid,b=JSON.parse(JSON.stringify(n));a.columns.map(function(a){if(a.enableFiltering&&a.filters[0].term){var c={wildcard:{}};c.wildcard[a.field]={value:["*",a.filters[0].term.toString().toLowerCase(),"*"].join("")},b.bool.must.push(c)}}),o.filter=b,q()}),b.gridApi.core.on.sortChanged(b,function(a,b){if(0===b.length)o.sort=[m];else{var c=!1,d=b.map(function(a){"id"===a.colDef.field&&(c=!0);var b={};return b[a.colDef.field]={order:a.sort.direction},b});c||d.push(m),o.sort=d}q()}),b.gridApi.pagination.on.paginationChanged(b,function(a,b){o.pageNumber=a,o.pageSize=b,q()})};var p=function(a){return{ROUID:a._source.ROUID,PATHTOCNAME:a._source.PATHTOCNAME,SOURCE:a._source.SOURCE,PLANER:a._source.PLANER,TODO29B:a._source.TODO29B,ASSESSMENT18Y:a._source.ASSESSMENT18Y,QUALITY18B:a._source.QUALITY18B,ASSESSMENT56Y:a._source.ASSESSMENT56Y,QUALITY56Y:a._source.QUALITY56Y,EQUIPPING:a._source.EQUIPPING,SITESTART:a._source.SITESTART,SITESTARTPR:a._source.SITESTARTPR,SITESTARTEPlus:a._source.SITESTARTEPlus,NESTART:a._source.NESTART,NESTARTTYPE:a._source.NESTARTTYPE,NESTARTSTATUS:a._source.NESTARTSTATUS,NESTARTKAT:a._source.NESTARTKAT,NESTARTDUEDATE:a._source.NESTARTDUEDATE,NESTARTPRJNAME:a._source.NESTARTPRJNAME,NESTARTST29B:a._source.NESTARTST29B,NESTARTST18B:a._source.NESTARTST18B,NESTARTST56Y:a._source.NESTARTST56Y,NESTARTST56YCOMMENT:a._source.NESTARTST56YCOMMENT,NESTARTST90:a._source.NESTARTST90,NESTARTST156Y:a._source.NESTARTST156Y,NESTARTST156YCOMMENT:a._source.NESTARTST156YCOMMENT,NESTARTST190:a._source.NESTARTST190,SITEEND:a._source.SITEEND,NEEND:a._source.NEEND,NEENDTYPE:a._source.NEENDTYPE,NEENDDUEDATE:a._source.NEENDDUEDATE,NEENDKAT:a._source.NEENDKAT,NEENDST62W:a._source.NEENDST62W,NEENDST90:a._source.NEENDST90,NEENDFT:a._source.NEENDFT,NEENDFTTYPE:a._source.NEENDFTTYPE,NEENDFTDUEDATE:a._source.NEENDFTDUEDATE,NEENDFTKAT:a._source.NEENDFTKAT,NEENDFTST76:a._source.NEENDFTST76,NEENDFTST90:a._source.NEENDFTST90,TYP:a._source.TYP,CAP:a._source.CAP,E1:a._source.E1,LEN:a._source.LEN,SITEPATH:a._source.SITEPATH,USRLINK_01:a._source.USRLINK_01,LINKREV_01:a._source.LINKREV_01,LINKVAR_01:a._source.LINKVAR_01,STATUS_01:a._source.STATUS_01,ST82S_01:a._source.ST82S_01,ST85S_01:a._source.ST85S_01,ST90S_01:a._source.ST90S_01,ST95S_01:a._source.ST95S_01,TDCN_01:a._source.TDCN_01,TODO_01:a._source.TODO_01,USRLINK_02:a._source.USRLINK_02,LINKREV_02:a._source.LINKREV_02,LINKVAR_02:a._source.LINKVAR_02,STATUS_02:a._source.STATUS_02,ST82S_02:a._source.ST82S_02,ST85S_02:a._source.ST85S_02,ST90S_02:a._source.ST90S_02,ST95S_02:a._source.ST95S_02,TDCN_02:a._source.TDCN_02,TODO_02:a._source.TODO_02,USRLINK_03:a._source.USRLINK_03,LINKREV_03:a._source.LINKREV_03,LINKVAR_03:a._source.LINKVAR_03,STATUS_03:a._source.STATUS_03,ST82S_03:a._source.ST82S_03,ST85S_03:a._source.ST85S_03,ST90S_03:a._source.ST90S_03,ST95S_03:a._source.ST95S_03,TDCN_03:a._source.TDCN_03,TODO_03:a._source.TODO_03,USRLINK_04:a._source.USRLINK_04,LINKREV_04:a._source.LINKREV_04,LINKVAR_04:a._source.LINKVAR_04,STATUS_04:a._source.STATUS_04,ST82S_04:a._source.ST82S_04,ST85S_04:a._source.ST85S_04,ST90S_04:a._source.ST90S_04,ST95S_04:a._source.ST95S_04,TDCN_04:a._source.TDCN_04,TODO_04:a._source.TODO_04,USRLINK_05:a._source.USRLINK_05,LINKREV_05:a._source.LINKREV_05,LINKVAR_05:a._source.LINKVAR_05,STATUS_05:a._source.STATUS_05,ST82S_05:a._source.ST82S_05,ST85S_05:a._source.ST85S_05,ST90S_05:a._source.ST90S_05,ST95S_05:a._source.ST95S_05,TDCN_05:a._source.TDCN_05,TODO_05:a._source.TODO_05,USRLINK_06:a._source.USRLINK_06,LINKREV_06:a._source.LINKREV_06,LINKVAR_06:a._source.LINKVAR_06,STATUS_06:a._source.STATUS_06,ST82S_06:a._source.ST82S_06,ST85S_06:a._source.ST85S_06,ST90S_06:a._source.ST90S_06,ST95S_06:a._source.ST95S_06,TDCN_06:a._source.TDCN_06,TODO_06:a._source.TODO_06,USRLINK_07:a._source.USRLINK_07,LINKREV_07:a._source.LINKREV_07,LINKVAR_07:a._source.LINKVAR_07,STATUS_07:a._source.STATUS_07,ST82S_07:a._source.ST82S_07,ST85S_07:a._source.ST85S_07,ST90S_07:a._source.ST90S_07,ST95S_07:a._source.ST95S_07,TDCN_07:a._source.TDCN_07,TODO_07:a._source.TODO_07,USRLINK_08:a._source.USRLINK_08,LINKREV_08:a._source.LINKREV_08,LINKVAR_08:a._source.LINKVAR_08,STATUS_08:a._source.STATUS_08,ST82S_08:a._source.ST82S_08,ST85S_08:a._source.ST85S_08,ST90S_08:a._source.ST90S_08,ST95S_08:a._source.ST95S_08,TDCN_08:a._source.TDCN_08,TODO_08:a._source.TODO_08,USRLINK_09:a._source.USRLINK_09,LINKREV_09:a._source.LINKREV_09,LINKVAR_09:a._source.LINKVAR_09,STATUS_09:a._source.STATUS_09,ST82S_09:a._source.ST82S_09,ST85S_09:a._source.ST85S_09,ST90S_09:a._source.ST90S_09,ST95S_09:a._source.ST95S_09,TDCN_09:a._source.TDCN_09,TODO_09:a._source.TODO_09,USRLINK_10:a._source.USRLINK_10,LINKREV_10:a._source.LINKREV_10,LINKVAR_10:a._source.LINKVAR_10,STATUS_10:a._source.STATUS_10,ST82S_10:a._source.ST82S_10,ST85S_10:a._source.ST85S_10,ST90S_10:a._source.ST90S_10,ST95S_10:a._source.ST95S_10,TDCN_10:a._source.TDCN_10,TODO_10:a._source.TODO_10,USRLINK_11:a._source.USRLINK_11,LINKREV_11:a._source.LINKREV_11,LINKVAR_11:a._source.LINKVAR_11,STATUS_11:a._source.STATUS_11,ST82S_11:a._source.ST82S_11,ST85S_11:a._source.ST85S_11,ST90S_11:a._source.ST90S_11,ST95S_11:a._source.ST95S_11,TDCN_11:a._source.TDCN_11,TODO_11:a._source.TODO_11,USRLINK_12:a._source.USRLINK_12,LINKREV_12:a._source.LINKREV_12,LINKVAR_12:a._source.LINKVAR_12,STATUS_12:a._source.STATUS_12,ST82S_12:a._source.ST82S_12,ST85S_12:a._source.ST85S_12,ST90S_12:a._source.ST90S_12,ST95S_12:a._source.ST95S_12,TDCN_12:a._source.TDCN_12,TODO_12:a._source.TODO_12,USRLINK_13:a._source.USRLINK_13,LINKREV_13:a._source.LINKREV_13,LINKVAR_13:a._source.LINKVAR_13,STATUS_13:a._source.STATUS_13,ST82S_13:a._source.ST82S_13,ST85S_13:a._source.ST85S_13,ST90S_13:a._source.ST90S_13,ST95S_13:a._source.ST95S_13,TDCN_13:a._source.TDCN_13,TODO_13:a._source.TODO_13,USRLINK_14:a._source.USRLINK_14,LINKREV_14:a._source.LINKREV_14,LINKVAR_14:a._source.LINKVAR_14,STATUS_14:a._source.STATUS_14,ST82S_14:a._source.ST82S_14,ST85S_14:a._source.ST85S_14,ST90S_14:a._source.ST90S_14,ST95S_14:a._source.ST95S_14,TDCN_14:a._source.TDCN_14,TODO_14:a._source.TODO_14}},q=function(){f.setStatus(g.processing());var a=o.pageSize,c=(o.pageNumber-1)*o.pageSize,d=o.sort,h=o.filter;e.getBsConnections(b.dbIndex,a,c,d,h,function(a,c,d){return a?void f.setStatus(g.failed(a)):(b.gridOptions.totalItems=c,b.gridOptions.data=[],d.map(function(a){b.gridOptions.data.push(p(a))}),void f.setStatus(g.success()))})};q()}]})}]),htBsConnections.factory("$bsConnections",["$rootScope","$database",function(a,b){"use strict";var c={};return c.getBsConnections=function(a,c,d,e,f,g){var h={key:"bsconnections"};b.getData(a,h,c,d,e,f,function(a){a&&0!==a.length?g(null,a.hits.total,a.hits.hits):g("Nothing found!",[])})},c.getSitePath=function(a,c,d){var e,f="path",g=99,h=0,i={term:{ROUID:c}};b.getData(a,f,g,h,e,i,function(a){return d([])})},c}]),htDatabase.factory("$database",["$http","$app",function(a,b){"use strict";var c="networknordhorn";b.getDbIndex(function(a){c=a});var d=function(a,b){var c=["/db",a,b,"_search"];return c.join("/")},e=function(a,b,c,e,f,g){return void 0===c&&(c=999),void 0===e&&(e=0),(void 0===g||g.bool&&0===g.bool.must.length)&&(g={match_all:{}}),{method:"POST",url:d(a,b),headers:{"Content-Type":"application/json"},data:{from:e,size:c,sort:f,query:g}}},f={};return f.resourceType="radio",f.tables={radio:{columns:[{id:0,name:"idRadio",width:40,cls:"text-right",query:"00"},{id:1,name:"type",width:100,query:"01"},{id:2,name:"family",width:60,query:"02"},{id:3,name:"manufacturer",width:100,query:"03"},{id:4,name:"model",width:"Auto",query:"04"},{id:5,name:"band",width:80,cls:"text-right",query:"05"},{id:6,name:"bandwidth",width:"Auto",cls:"text-right",query:"06"},{id:7,name:"xPic",width:80,query:"07"},{id:8,name:"transTech",width:100,query:"08"},{id:9,name:"config",width:40,query:"09"}],search:{}},RadioConfigurations:{columns:[{id:0,name:"message",width:"Auto",query:"10"}],search:{}},RadioModes:{columns:[{id:0,name:"message",width:"Auto",query:"21"}],search:{}},antenna:{columns:[{id:0,name:"idAntenna",width:40,query:"30"},{id:1,name:"model",width:200,query:"31"},{id:2,name:"band",width:80,cls:"text-right",query:"32"},{id:3,name:"fLow",width:100,query:"33"},{id:4,name:"fHigh",width:100,query:"34"},{id:5,name:"xpd",width:80,query:"35"},{id:6,name:"dia",width:80,query:"36"},{id:7,name:"type",width:80,query:"37"},{id:8,name:"xPol",width:40,query:"38"},{id:9,name:"gain",width:40,query:"39"}],search:{}},waveguide:{columns:[{id:0,name:"model",width:"Auto",query:"40"},{id:1,name:"band",width:80,cls:"text-right",query:"41"},{id:2,name:"minLength",width:100,cls:"text-right",query:"42"},{id:3,name:"maxLength",width:100,cls:"text-right",query:"43"},{id:4,name:"lossM",width:80,cls:"text-right",query:"44"},{id:5,name:"type",width:80,query:"45"},{id:6,name:"typeFine",width:80,query:"46"},{id:7,name:"procStat",width:80,query:"47"}],search:{}},Parameters:{columns:[{id:0,name:"message",width:"Auto",query:"50"}],search:{}},Rain:{columns:[{id:0,name:"message",width:"Auto",query:"60"}],search:{}}},f.getMappings=function(b,c){var d={method:"GET",url:"/db/"+b,headers:{"Content-Type":"application/json"}};a(d).success(function(a){return c(null,a[b].mappings)}).error(function(a,b){return console.info("htLog: ERROR",a,b),c("An error occured: "+b,null)})},f.count=function(b,c,d){var e=["/db",b,c.join(","),"_search"],f={method:"POST",url:e.join("/"),headers:{"Content-Type":"application/json"},data:{size:0,facets:{counts:{terms:{field:"_type"}}}}};a(f).success(function(a){return d(a.facets.counts)}).error(function(a,b){return console.info("htLog:",a,b),d([])})},f.getData=function(b,c,d,f,g,h,i){var j=e(b,c.key,d,f,g,h);a(j).success(function(a){i(a)}).error(function(a,b){console.info("htLog: ERROR",a,b),i([])})},f.getTableData=function(b,c,d){var g=e(b,c);a(g).success(function(a){f.tables[c].rows=a.hits.hits,d(null,f.tables[c])}).error(function(a,b){f.tables[a.output.resourceType].rows=[],d("An error occured: "+b,null)})},Object.keys(f.tables).map(function(a){var b=f.tables[a];b.columns.map(function(a){a.query="",b.search[a.name]=a.query})}),f}]),"undefined"==typeof String.prototype.contains&&(String.prototype.contains=function(a){return-1!==this.indexOf(a)});var htProfil=angular.module("htProfile",["ui.bootstrap","base64","htLogin","alert","translate"]);htProfil.config(["$stateProvider",function(a){"use strict";a.state("profil",{url:"/profile",templateUrl:"modules/profile/profile.html",controller:["$rootScope","$scope","$uibModal","$base64","profileService","siteMarkerService","authenticationService","alertService","translateService",function(a,b,c,d,e,f,g,h,i){var j=new ZeroClipboard(document.getElementById("copy-button"));j.on("copy",function(a){var c=a.clipboardData;c.setData("text/plain",JSON.stringify(b.profile,null," "))}),b.openPaste=function(){var a=c.open({animation:!0,templateUrl:"/ux/modules/profile/profile.paste.html",controller:"ModalInstanceCtrl",size:"lg",resolve:{items:function(){return b.items}}});a.result.then(function(a){try{var c=JSON.parse(a);"0.1.0"===c.common.version?b.profile=c:console.info("Not a valid profile ;( ")}catch(d){return console.info("Not a valid profile ;( "),!1}},function(){})},b.profileId=g.getProfileName(),b.username=g.getUsername(b.profileId),a.title="("+b.username+") htProfile",h.setMessage(["LOADING","SUCCESS","FAILED"]),b.changeLanguage=i.changeLanguage,b.status=h.processing(),b.shape=f.shape,b.stroke={types:["solid","dotted","dashed","double"]};var k={};k.points=["site","siteHasFiber","siteHasFiberPlanned","siteIsAggregator","siteNew"],k.lines=["siteLink","siteLinkPlanned","siteLinkEngineered","path"];var l=function(a){return k.points.join("/").contains(a)||k.lines.join("/").contains(a)||(a=k.points[0],b.object.id=a),["/ux/modules/profile/templates/",a,".html"].join("")};b.object={},b.object.id="site",b.object.url=l(b.object.id),b.selected=function(a){b.object.id=a,b.object.url=l(a),k.points.join("/").contains(a)?y():k.lines.join("/").contains(a)&&x()},b.profile=null,b.profile||e.getProfileData(b.profileId,function(a,c){a?(b.status=h.failed(a),b.profile=null):(b.status=h.success(),b.profile=c,b.profile.site.active=!0,b.object.id="site",y())}),b.restoreDefaults=function(){e.profile=e.defaultProfile,b.profile=e.defaultProfile},b.apply=function(){b.status=h.processing(),e.apply(b.profileId,b.profile,function(a,c){a?b.status=h.failed(a):(b.status=h.success(),b.profile=c)})};var m={latitude:52.25566931416853,longitude:12.98757791519165},n={mapTypeId:"hybrid",backgroundColor:"#dd0000",draggable:!1,disableDoubleClickZoom:!1,mapTypeControl:!0,panControl:!0,rotateControl:!1,streetViewControl:!1,overviewMapControl:!1,zoomControl:!0,scaleControl:!1,scrollwheel:!1};b.map={center:m,options:n,zoom:18};var o={click:function(a,b,c,d){},mouseover:function(a,b,c,d){({type:c.type,status:"hover"})},mouseout:function(a,b,c,d){({type:c.type,status:"normal"})}},p={click:function(a,b,c,d){},mouseover:function(a,b,c,d){({type:c.type,status:"hover"})},mouseout:function(a,b,c,d){({type:c.type,status:"normal"})}},q={click:function(a,b,c,d){},mouseover:function(a,c,d,e){var g={type:d.type,status:"hover"};f.createSiteMarker(d.id,d.site,g,function(a){d.icon=a.icon,b.$apply()})},mouseout:function(a,c,d,e){var g={type:d.type,status:"normal"};f.createSiteMarker(d.id,d.site,g,function(a){d.icon=a.icon,b.$apply()})}},r=0,s={lat:b.map.center.latitude,lon:b.map.center.longitude},t={_index:"configuration",id:{siteId:r++},siteName:"Site A",geoLocation:{location:s},siteLinks:["ExampleSiteLink"],siteExtensions:{concentrator:!1,fiberPlanDate:null,fiberActualDate:null}},u=JSON.parse(JSON.stringify(t));u.id.siteId=r++,u.geoLocation.location.lat=t.geoLocation.location.lat+.1,u.geoLocation.location.lon=t.geoLocation.location.lon+.1,u.siteName="Site B";var v=JSON.parse(JSON.stringify(t));v.id.siteId=r++,v.geoLocation.location.lat=t.geoLocation.location.lat+.05,v.geoLocation.location.lon=t.geoLocation.location.lon+.2,v.siteName="Site C",b.mapObjects={sites:{events:q,models:[],rebuild:!1},siteLinks:{events:o,models:[],visible:!0,rebuild:!1},paths:{events:p,models:[],visible:!1,rebuild:!1}};var w=function(a,b,c){var d=e.profile[b.type][b.status],f=d.stroke.color,g=d.stroke.width,h=d.stroke.opacity,i=10/g,j={path:"M 0,0 v-"+i,strokeOpacity:h,scale:g},k=[];a.map(function(a){k.push({latitude:a.geoLocation.location.lat,longitude:a.geoLocation.location.lon})});var l=a[0].id.siteId+"-"+a[a.length-1].id.siteId,m={id:r++,index:"configuration",siteLinkId:l,path:k,icons:[{icon:j,offset:"0%",repeat:"20px"}],stroke:{color:f,weight:g,opacity:.1},editable:!1,draggable:!1,geodesic:!0,visible:!0,options:{zIndex:16,title:l}};c(m)},x=function(){var a={type:"site",status:"normal"};f.createSiteMarker(1,u,a,function(a){b.mapObjects.sites.models.length<2&&b.mapObjects.sites.models.push(a),b.mapObjects.sites.models[0].icon=a.icon,b.mapObjects.sites.models[1].icon=a.icon});var c=[t,u],d={type:b.object.id,status:"normal"};w(c,d,function(a){b.mapObjects.siteLinks.models=[a]});var e=t.geoLocation.location,g=u.geoLocation.location;b.map.center={latitude:e.lat+(g.lat-e.lat)/2,longitude:e.lon+(g.lon-e.lon)/2},b.map.zoom=11},y=function(){var a={type:b.object.id,status:"normal"};"site"===a.type?(t.siteExtensions.concentrator=!1,t.siteExtensions.fiberPlanDate=null,t.siteExtensions.fiberActualDate=null):"siteHasFiber"===a.type?(t.siteExtensions.concentrator=!1,t.siteExtensions.fiberPlanDate=new Date,t.siteExtensions.fiberActualDate=new Date):"siteHasFiberPlanned"===a.type?(t.siteExtensions.concentrator=!1,t.siteExtensions.fiberPlanDate=new Date,t.siteExtensions.fiberActualDate=null):"siteNew"===a.type?(t.siteExtensions.concentrator=!1,t.siteExtensions.fiberPlanDate=null,t.siteExtensions.fiberActualDate=null):"siteIsAggregator"===a.type&&(a.type="site",t.siteExtensions.concentrator=!0,t.siteExtensions.fiberPlanDate=null,t.siteExtensions.fiberActualDate=null),f.createSiteMarker(0,t,a,function(a){0===b.mapObjects.sites.models.length&&b.mapObjects.sites.models.push(a),b.mapObjects.sites.models[0].icon=a.icon}),b.mapObjects.sites.models.length>1&&b.mapObjects.sites.models.splice(1,b.mapObjects.sites.models.length),b.mapObjects.siteLinks.models=[],b.mapObjects.paths.models=[],b.map.center=m,b.map.zoom=18};b.$watch("profile",function(a,c){var d=b.object.id;k.points.join("/").contains(d)?y():k.lines.join("/").contains(d)&&x()},!0)}]})}]),htProfil.controller("ModalInstanceCtrl",["$scope","$uibModalInstance",function(a,b){a.text="Paste your profile json string here.",a.ok=function(){b.close(a.text)},a.cancel=function(){b.dismiss("cancel")}}]),htProfil.factory("profileService",["$http",function(a){"use strict";var b={common:{language:"en_US",mapTypeId:"hybrid",viewBox:{},version:"0.1.0"},site:{shape:{type:"circle",scale:8,rotation:45,zIndex:10},normal:{stroke:{color:"#00ccff",width:3,type:"solid",opacity:.9},fill:{color:"#00ccff",opacity:.5}},hover:{stroke:{color:"#00ccff",width:3,type:"solid",opacity:.9},fill:{color:"#00ccff",opacity:.8}}},siteHasFiber:{shape:{type:"circle",scale:8,rotation:45,zIndex:10},normal:{stroke:{color:"#ffff00",width:3,type:"solid",opacity:.9},fill:{color:"#ffff00",opacity:.5}},hover:{stroke:{color:"#ffff00",width:3,type:"solid",opacity:.9},fill:{color:"#ffff00",opacity:.8}}},siteHasFiberPlanned:{shape:{type:"circle",scale:8,rotation:45,zIndex:10},normal:{stroke:{color:"#ffff00",width:3,type:"solid",opacity:.9},fill:{color:"#00ccff",opacity:.5}},hover:{stroke:{color:"#ffff00",width:3,type:"solid",opacity:.9},fill:{color:"#00ccff",opacity:.8}}},siteIsAggregator:{shape:{scale:16,rotation:45,zIndex:10}},siteNew:{shape:{type:"circle",scale:8,rotation:45,zIndex:10},normal:{stroke:{color:"#dd0000",width:3,type:"solid",opacity:.9},fill:{color:"#dd0000",opacity:.5}},hover:{stroke:{color:"#dd0000",width:5,type:"solid",opacity:.9},fill:{color:"#dd0000",opacity:.8}}},siteLink:{normal:{stroke:{color:"#00ccff",width:3,type:"solid",opacity:.9}},hover:{stroke:{color:"#00ccff",width:3,type:"solid",opacity:.9}},zIndex:5},cluster:{shape:{type:"circle",scale:50,rotation:45,zIndex:10},normal:{stroke:{color:"#00ccff",width:0,type:"solid",opacity:.9},fill:{color:"#00ccff",opacity:.3}},hover:{stroke:{color:"#00ccff",width:3,type:"solid",opacity:.5},fill:{color:"#00ccff",opacity:.4}},zIndex:5},newSiteLink:{normal:{stroke:{color:"#dd0000",width:3,type:"solid",opacity:.9}},hover:{stroke:{color:"#dd0000",width:3,type:"solid",opacity:.9}},zIndex:5},selectedSite:{shape:{type:"circle",scale:8,rotation:45,zIndex:10},normal:{stroke:{color:"#dd0000",width:3,type:"solid",opacity:.9},fill:{color:"#dd0000",opacity:.5}},hover:{stroke:{color:"#dd0000",width:5,type:"solid",opacity:.9},fill:{color:"#dd0000",opacity:.8}}},selectedSiteLink:{normal:{stroke:{color:"#00ccff",width:3,type:"solid",opacity:.9}},hover:{stroke:{color:"#00ccff",width:3,type:"solid",
opacity:.9}},zIndex:5}},c=function(a){var b="configuration",c="profile",d="/db/"+b+"/"+c+"/"+a;return d},d=function(d,e){var f=b;f.common.lastChange=new Date;var g={method:"PUT",url:c(d),headers:{"Content-Type":"application/json"},data:f};a(g).success(function(a,c){return e(null,b)}).error(function(a,b){return e(b,null)})},e={};return e.profile=b,e.defaultProfile=b,e.apply=function(b,d,e){d.common.lastChange=new Date;var f={method:"PUT",url:c(b),headers:{"Content-Type":"application/json"},data:d};a(f).success(function(a,b){return e(null,d)}).error(function(a,b){return e(b,null)})},e.restoreDefaults=function(d,f){var g=b;g.common.lastChange=new Date;var h={method:"PUT",url:c(d),headers:{"Content-Type":"application/json"},data:g};a(h).success(function(a,c){return e.profile=b,f(null,b)}).error(function(a,b){return f(b,null)})},e.getProfileData=function(b,f){var g={method:"GET",url:c(b),headers:{"Content-Type":"application/json"}};a(g).success(function(a){return e.profile=a._source,f(null,a._source)}).error(function(a,c){return 400!==c&&404!==c?f(c,null):void d(b,function(a,b){return f(null,b)})})},e}]),"undefined"==typeof Array.prototype.contains&&(Array.prototype.contains=function(a){return-1!==this.join("/").indexOf(a)}),"undefined"==typeof Array.prototype.diff&&(Array.prototype.diff=function(a){return this.filter(function(b){return a.indexOf(b)<0})});var app=angular.module("htNetworkMap",["uiGmapgoogle-maps","ui.bootstrap","ui.router","angular-geohash","ngCookies","htLogin","htProfile","htRevisionStatus","htQueryService","htPathManager","htPathDetails","alert","translate","coordinateFilter"]);app.controller("mapCtrl",["$rootScope","$scope","$location","$compile","geohash","$query","$networkMap","siteMarkerService","$htCluster","$mapOverlay","$revisionStatus","authenticationService",function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";var m;a.$on("$locationChangeSuccess",function(b,d,e,h,i){m=c.path().split("/")[1];var j=c.search();if(a.mapObjects.paths.models=[],0!==Object.keys(j).length){var k={};k.dbIndex=m,k.objectType=Object.keys(j)[0],"path"===k.objectType?k.value=j[k.objectType].split("|"):k.value=j[k.objectType],f.query(k,function(a){g.handleQueryResult(a)})}});var n,o=l.getProfileName(),p=0,q={latitude:0,longitude:0},r={maxZoom:14,minimumClusterSize:8,maxSiteCountToDisplayLinks:400,minimumObjectsForClustering:400},s={bounds_changed:function(a,b,c){},click:function(a,b,c){g.infowindowOpen=null,g.infowindow.close()},heading_changed:function(a,b,c){},idle:function(c,d,e){var f=c.getBounds();m&&!f.equals(b.previousBounds)&&(a.map.zoom=c.getZoom(),b.isProsessing=!0,S(c.getBounds(),function(){b.isProsessing=!1,b.previousBounds=f,ba=!0}))},maptypeid_changed:function(a,b,c){},resize:function(a,b,c){},rightclick:function(b,c,d){a.mapObjects.newSite.create(d[0].latLng)},projection_changed:function(a,b,c){n=a.getProjection()},zoom_changed:function(a,b,c){}},t={mapTypeId:"hybrid",backgroundColor:"#dd0000",draggable:!0,disableDoubleClickZoom:!1,minZoom:3,mapTypeControl:!1,mapTypeControlOptions:{position:google.maps.ControlPosition.LEFT_TOP,mapTypeIds:["hybrid","roadmap","terrain","satellite"]},panControl:!0,panControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},rotateControl:!0,rotateControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},overviewMapControl:!0,overviewMapControlOptions:{opened:!0},zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},scaleControl:!0,scrollwheel:!0};a.map={center:q,clusterOptions:r,control:{},events:s,options:t,zoom:3},b.doCluster=!1,b.doHtCluster=!0,b.doGoogleCluster=!1;var u=function(b){a.mapObjects.clusters.models.push(b)},v=function(b,c){var d=a.mapObjects.clusters.getByKey(b);if(void 0!==d){var e={doc_count:d.model.options.labelContent,key:b},f=y(e);d.setIcon(f),c()}},w=function(b){return a.mapObjects.clusters.models.map(function(a){return a.mykey}).indexOf(b)>-1},x=function(b,c){var d;if(b.doc_count>=a.map.clusterOptions.minimumClusterSize){var f="opt5";b.doc_count>1&&b.doc_count<99999&&(f="opt"+b.doc_count.toString().length);var g=e.decode(b.key),h=y(b);d={id:p++,isCluster:!0,mykey:b.key,latitude:g.latitude,longitude:g.longitude,icon:h,showWindow:!1,title:b.key+": "+b.doc_count,options:{zIndex:10,draggable:!1,labelContent:b.doc_count,labelAnchor:a.mapObjects.clusters.options[f].anchor,labelClass:"labelClass"}}}return c(d)},y=function(b){var c=b.doc_count,d="opt5",f=5;c>0&&99999>c&&(f=c.toString().length,d="opt"+f);var g=e.decode_bbox(b.key),h=new google.maps.LatLng(g[0],g[1]),i=new google.maps.LatLng(g[2],g[3]),j=n.fromLatLngToPoint(h),k=n.fromLatLngToPoint(i),l=1<<a.map.zoom,m=Math.abs(parseInt((k.y-j.y)*l)),o=Math.abs(parseInt((k.x-j.x)*l)),p=-o/2,q=-m/2,r="M "+p+","+q+" h+"+(o-0)+" v+"+(m-0)+" h-"+(o-0)+" z";return{path:r,scale:1,strokeWeight:f,strokeColor:"#0CF",fillColor:"#0CF",fillOpacity:2*f/10,anchor:new google.maps.Point(0,0)}},z=function(c,d){return b.previousZoom!==a.map.zoom&&(a.mapObjects.clusters.models=[]),c.map(function(b){var c=b.center.location.lat,d=b.center.location.lon,f=e.encode(c,d,7);a.mapObjects.clusters.contains(f)}),d()},A=function(b,c){var d=[];g.getClusters(b,function(b,e){a.mapObjects.clusters.previousPrecision!==e&&(a.mapObjects.clusters.previousPrecision>e&&(a.mapObjects.siteLinks.models=[],a.mapObjects.sites.models=[]),a.mapObjects.clusters.removeAll(),a.mapObjects.clusters.previousPrecision=e);var f=[];b.map(function(b){a.mapObjects.clusters.create(b,function(a){void 0!==a?f.push(a):d.push(b.key)})}),a.mapObjects.clusters.models=f;var i=a.mapObjects.sites.models;g.getSitesByGeoHashes(d,function(b){var d={};b.map(function(b){if(void 0===d[b._index]&&(d[b._index]=[]),-1===d[b._index].indexOf(b.fields.forMap[0].id.siteId)&&d[b._index].push(b.fields.forMap[0].id.siteId),!a.mapObjects.sites.contains(b.fields.forMap[0].id.siteId)){b.fields.forMap[0]._index=b._index;var c={type:"site",status:"normal",visible:a.mapObjects.sites.visible};h.createSiteMarker(p++,b.fields.forMap[0],c,function(a){i.push(a)})}}),T(d,function(){c()})})})},B={click:function(b,c,d,e){a.map.center={latitude:d.latitude,longitude:d.longitude},a.map.zoom=a.map.zoom+3},dragstart:function(a,b,c,d){g.infowindow.close()}},C=function(b){for(var c=a.mapObjects.clusters.control.getGMarkers(),d=c.length;c[--d]&&c[d].model.mykey!==b;);return c[d]},D={opt1:{scale:8,anchor:"4 8"},opt2:{scale:13,anchor:"7 8"},opt3:{scale:16,anchor:"11 8"},opt4:{scale:19,anchor:"15 8"},opt5:{scale:22,anchor:"19 8"}},E=function(){a.mapObjects.clusters.models=[]},F=function(b){a.mapObjects.clusters.models=b},G=function(b){return a.mapObjects.sites.models.map(function(a){return a.site.id.siteId}).indexOf(b)>-1},H={click:function(b,c,e,f){if(null===g.infowindowOpen||void 0===g.infowindowOpen||g.infowindowOpen!==e.siteId){g.infowindowOpen=e.site.id.siteId;var h="<site-details site-index=\"'"+m+"'\" site-id=\"'"+e.site.id.siteId+"'\"></site-details>",i=d(h)(a);g.handleInfoWindow(f[0].latLng,i[0])}else g.infowindowOpen=null,g.infowindow.close()},dragstart:function(a,b,c,d){g.infowindow.close()},mouseover:function(a,c,d,e){if(d.isCluster)a.icon.strokeWeight=5,a.setIcon(a.icon);else{var f={type:d.type,status:"hover"};d.icon=h.getIcon(d.site,f),b.$apply()}},mouseout:function(a,c,d,e){if(d.isCluster)a.icon.strokeWeight=d.options.labelContent.toString().length,a.setIcon(a.icon),b.$apply();else{var f={type:d.type,status:"normal"};d.icon=h.getIcon(d.site,f),b.$apply()}}},I=function(b,c){for(var d=a.mapObjects.sites.models,e=d.length;e;)e-=1,d[e].site.id.siteId.toString()===c.toString()&&d.splice(e,1)},J=function(b){return a.mapObjects.siteLinks.models.map(function(a){return a.siteLinkId}).indexOf(b)>-1},K={click:function(b,c,e,f){if(void 0!==e.siteLinkId)if(null===g.infowindowOpen||"undefined"===g.infowindowOpen||g.infowindowOpen!==e.siteLinkId){g.infowindowOpen=e.siteLinkId;var h="<site-link-details site-link-index=\"'";h+=e.index,h+="'\" site-link-id-low=\"'",h+=e.siteLinkId.low,h+="'\" site-link-id-high=\"'",h+=e.siteLinkId.high,h+="'\"></site-link-details>";var i=d(h)(a);g.handleInfoWindow(f[0].latLng,i[0])}else g.infowindowOpen=null,g.infowindow.close()},mouseover:function(a,b,c,d){c.stroke.weight=6},mouseout:function(a,b,c,d){c.stroke.weight=3}},L={click:function(b,c,e,f){if(void 0!==e.id)if(null===g.infowindowOpen||"undefined"===g.infowindowOpen||g.infowindowOpen!==e.id){g.infowindowOpen=e.id;var h="<site-path-details db-index=\"'"+e.index+"'\" site-path-id=\"'"+e.id+"'\"></site-path-details>",i=d(h)(a);g.handleInfoWindow(f[0].latLng,i[0])}else g.infowindowOpen=null,g.infowindow.close()},mouseover:function(a,b,c,d){var e=10;1===c.icons.length?(c.stroke.weight=e,c.icons[0].icon.scale=e):(c.stroke.weight=e,c.icons[0].icon.scale=e,c.icons[1].icon.scale=e)},mouseout:function(a,b,c,d){var e=6;1===c.icons.length?(c.stroke.weight=e,c.icons[0].icon.scale=e):(c.stroke.weight=e,c.icons[0].icon.scale=e,c.icons[1].icon.scale=e)}},M=function(c){var d={lat:c.lat(),lon:c.lng()},e={_index:m,id:{siteId:-1},siteName:"New site at "+d.lat.toFixed(6)+"/"+d.lon.toFixed(6),siteExtensions:{concentrator:!1,fiberPlanDate:null,fiberActualDate:null},geoLocation:{location:d},siteLinks:[]},f={type:"siteNew",status:"normal"};h.createSiteMarker(p++,e,f,function(c){a.mapObjects.newSite.model.push(c),b.$apply()})};a.cancelSite=function(){g.infowindow.close(),a.mapObjects.newSite.model=[]},a.createNewSiteOnMap=function(b,c){a.cancelSite();var d={_index:m,id:{siteId:b.site._source.id.siteId},siteName:b.site._source.id.siteId,siteExtensions:{concentrator:!1,fiberPlanDate:null,fiberActualDate:null},geoLocation:b.site._source.geoLocation,siteLinks:[]},e={type:"site",status:"normal"};h.createSiteMarker(p++,d,e,function(b){return a.mapObjects.sites.models.push(b),c()})};var N={click:function(b,c,f,h){if(null===g.infowindowOpen||void 0===g.infowindowOpen||g.infowindowOpen!==f.siteId){g.infowindowOpen=f.siteId;var i=f.latitude.toFixed(6),j=f.longitude.toFixed(6),k=e.encode(i,j,9),l="<new-site name=\"'"+k+"'\" lat="+i+" lon="+j+"></new-site>",m=d(l)(a);g.handleInfoWindow(h[0].latLng,m[0])}else g.infowindowOpen=null,g.infowindow.close()},dragstart:function(a,b,c,d){g.infowindow.close()},mouseover:function(a,c,d,e){a.icon.strokeWeight=5,a.setIcon(a.icon),b.$apply()},mouseout:function(a,c,d,e){d.isCluster?a.icon.strokeWeight=d.options.labelContent.toString().length:a.icon.strokeWeight=3,a.setIcon(a.icon),b.$apply()}},O=function(a,b){g.removeSite(a,b,function(c,d){c?console.info("htLog:",c,d):(g.infowindow.close(),I(a,b))})};a.removeSite=function(b,c){a.mapObjects.sites.remove(b,c)},a.cancelSiteLink=function(){g.infowindow.close(),b.newLink.line.setMap(null),b.newLink.clear()};var P=function(b,c){for(var d=a.mapObjects.siteLinks.models,e=d.length,f=!1;!f;)e-=1,f=d[e]&&d[e].siteLinkId.low.toString()===c.low.toString()&&d[e].siteLinkId.high.toString()===c.high.toString()&&d[e].index===b;e>-1&&d.splice(e,1)},Q=function(a,b){g.removeSiteLink(a,b,function(c,d){c||(g.infowindow.close(),P(a,b))})};a.removeSiteLink=function(b,c){a.mapObjects.siteLinks.remove(b,c)},a.createMwrLink=function(b,c){g.infowindowOpen="newMwrLink";var e="<new-mwr-link ";e+='db-index="',e+=b,e+='" site-id-a="',e+=c.high,e+='" site-id-b="',e+=c.low,e+='" revision-type="',e+="construction",e+='"></new-mwr-link>';var f=d(e)(a);g.handleInfoWindow(g.infowindow.getPosition(),f[0])};var R=function(b){g.infowindowOpen=b.siteLinkId;var c="<site-link-details site-link-index=\"'";c+=b.dbIndex,c+="'\" site-link-id-low=\"'",c+=b.siteLinkId.low,c+="'\" site-link-id-high=\"'",c+=b.siteLinkId.high,c+="'\"></site-link-details>";var e=d(c)(a);g.handleInfoWindow(g.infowindow.getPosition(),e[0])};a.cancelMwrLink=function(a){R(a)},a.mwrLinkCreated=function(a,b){var c={revisionState:{orderId:5,id:"created",name:"Created",isMain:!0},required:new Date,plan:new Date,actual:new Date,planner:l.getUsername(o),comment:"Creation via htNetworkMap."},d={};d.id=b.mwrlinkrevision.id,d.lifeCycle={},d.lifeCycle.revisionFlags=[],d.lifeCycle.revisionFlags.push(c),k.set(m,d,function(b,c){R(a)})},a.mapObjects={sites:{contains:G,events:H,models:[],circles:[],remove:O,visible:!0},siteLinks:{contains:J,events:K,models:[],remove:Q,visible:!0},paths:{events:L,models:[],visible:!0},clusters:{add:u,changeIcon:v,contains:w,control:{},create:x,draw:A,events:B,getByKey:C,models:[],options:D,removeAll:E,replace:F},newSite:{create:M,events:N,model:[]},selectedSites:{create:"äää",list:[],models:[]},newSiteLink:{models:[]},urban:{models:[],events:{},visible:!1},suburban:{models:[],events:{},visible:!1}};var S=function(c,d){var e={northeast:{latitude:c.getNorthEast().lat(),longitude:c.getNorthEast().lng()},southwest:{latitude:c.getSouthWest().lat(),longitude:c.getSouthWest().lng()}};if(b.doCluster&&(a.map.zoom<a.map.clusterOptions.maxZoom?a.mapObjects.clusters.draw(e,function(){d()}):(a.mapObjects.clusters.removeAll(),X(e,function(){d()}))),b.doHtCluster){var f=a.map.clusterOptions.minimumClusterSize,h=a.map.clusterOptions.minimumObjectsForClustering;i.getMapObjects(e,f,h,function(c,d){z(c,function(){}),V(d,function(){b.previousZoom=a.map.zoom,g.statistics.sites.displayed=a.mapObjects.sites.models.length})})}else 0===a.mapObjects.sites.models.length&&X(e,function(){d()})};a.createNewSitelinkInDB=function(b,c){a.cancelSiteLink(),U(b,function(b){return b&&a.mapObjects.siteLinks.models.push(b),c()})};var T=function(b,c){var d=Object.keys(b);d.map(function(d){var e=a.mapObjects.siteLinks.models;return b[d].length>a.map.clusterOptions.maxSiteCountToDisplayLinks?(g.getSiteLinksByBounds(a.map.bounds,function(a){a.map(function(a){U(a,function(a){a&&e.push(a)})})}),void c()):void g.getSiteLinksBySiteIds(d,b[d],function(a){a.map(function(a){U(a,function(a){a&&e.push(a)})}),c()})})},U=function(a,b){if(void 0===a._source.id)return b(void 0);var c="#00CCFF";a._source.dbOriginations.contains("PMTS")&&(c="#00FF00"),a._source.dbOriginations.contains("PMTS")&&a._source.dbOriginations.contains("SMTX")&&(c="#FFFF00"),void 0!==a._source.fiberPlanDateA&&void 0!==a._source.fiberPlanDateB&&(null!==a._source.fiberPlanDateA&&null!==a._source.fiberPlanDateB||null!==a._source.fiberPlanDateA&&1===a._source.numSiteLinksA||null!==a._source.fiberPlanDateB&&1===a._source.numSiteLinksB)&&(c="#EEEEEE",a._source.dbOriginations.contains("PMTS")&&(c="#FF0000"));var d=[{latitude:a._source.geoLocationA.location.lat,longitude:a._source.geoLocationA.location.lon},{latitude:a._source.geoLocationB.location.lat,longitude:a._source.geoLocationB.location.lon}],e=a._source.id.high+"-"+a._source.id.low;void 0===a._index&&(a._index=m);var f={id:p++,index:a._index,siteLinkId:a._source.id,path:d,stroke:{color:c,weight:3},editable:!1,draggable:!1,geodesic:!0,visible:!0,options:{zIndex:16,title:e}};b(f)},V=function(d,e){var f=b.previousZoom>a.map.zoom&&0===c.path().indexOf("?"),i={};return d.map(function(b){if(!a.mapObjects.sites.contains(b._source.id.siteId)){void 0===i[m]&&(i[m]=[]),-1===i[m].indexOf(b._source.id.siteId)&&i[m].push(b._source.id.siteId);var c={type:"site",status:"normal",visible:a.mapObjects.sites.visible};h.createSiteMarker(p++,b._source,c,function(b){a.mapObjects.sites.models.push(b)})}}),void 0!==i[m]&&g.getSiteLinksBySiteIds(m,i[m],function(b){f&&(a.mapObjects.siteLinks.models=[]),b.map(function(b){var c=b._source.id.high+"-"+b._source.id.low;a.mapObjects.siteLinks.contains(c)||U(b,function(b){b&&a.mapObjects.siteLinks.models.push(b)})})}),a.mapObjects.sites.models.length>0&&W(a.mapObjects.sites.models,d,function(){}),e()},W=function(a,b,c){var d=b.map(function(a){return a._source.id.siteId}),e=a.map(function(a){return a.site.id.siteId}),f=e.diff(d);return f.map(function(b){var c=e.indexOf(b);c>-1&&(e.splice(c,1),a.splice(c,1))}),c()},X=function(b){g.getSites(b,function(b){var c=a.mapObjects.sites.models,d={};b.map(function(b){if(!a.mapObjects.sites.contains(b.fields.forMap[0].id.siteId)){void 0===d[b._index]&&(d[b._index]=[]),-1===d[b._index].indexOf(b.fields.forMap[0].id.siteId)&&d[b._index].push(b.fields.forMap[0].id.siteId),b.fields.forMap[0]._index=b._index;var e={type:"site",status:"normal",visible:a.mapObjects.sites.visible};h.createSiteMarker(p++,b.fields.forMap[0],e,function(a){c.push(a)})}}),a.mapObjects.sites.models=c,T(d,function(){})})},Y=function(c){h.init(o),g.getDbIndex(function(d){m=d,g.getStatistics(function(c,d){if(c)console.info("htLog:",c);else{g.setMap(a.map),a.map.zoom=g.googleMap().getZoom(),b.isProsessing=!0;var e=j.getOverlay(g.googleMap(),a.map.options.minZoom,a.map.clusterOptions.maxZoom);g.googleMap().overlayMapTypes.insertAt(0,e),S(g.googleMap().getBounds(),function(){b.isProsessing=!1,ba=!0})}}),g.getBounds(function(b){a.map.bounds=b,g.setOptions(a.map.options)}),c()}),g.infowindow=new google.maps.InfoWindow},Z=function(a){var b=this.sites.map(function(a){return a.id.siteId}).indexOf(a.id.siteId);return b>-1?(this.sites.splice(b,1),aa(a),this.remove(),!1):this.sites.length<this.maxSites?(g.infowindow.close(),this.sites.push(a),_(a),this.create(),!0):!1},$=function(c){g.infowindowOpen="newSiteLink";var e='<new-site-link site-id-a="';e+=b.newLink.sites[0].id.siteId,e+='" site-id-b="',e+=b.newLink.sites[1].id.siteId,e+='"></new-site-link>';var f=d(e)(a);g.handleInfoWindow(c,f[0])};a.newLink={minSites:2,maxSites:2,sites:[],line:void 0,mode:function(a){return this.sites.map(function(a){return a.id}).indexOf(a)>-1},remove:function(){void 0!==this.line&&this.line.setMap(null)},create:function(){if(this.sites.length===this.minSites){var c="#dd0000",d=[new google.maps.LatLng(this.sites[0].geoLocation.location.lat,this.sites[0].geoLocation.location.lon),new google.maps.LatLng(this.sites[1].geoLocation.location.lat,this.sites[1].geoLocation.location.lon)];this.line=new google.maps.Polyline({path:d,geodesic:!0,map:a.map.control.getGMap(),strokeColor:c,strokeOpacity:1,strokeWeight:3,zIndex:6});var e=(d[0].lat()+d[1].lat())/2,f=(d[0].lng()+d[1].lng())/2,h=new google.maps.LatLng(e,f);$(h),google.maps.event.addListener(this.line,"click",function(a){null===g.infowindowOpen||"undefined"===g.infowindowOpen?$(a.latLng):(g.infowindowOpen=null,g.infowindow.close())}),google.maps.event.addListener(this.line,"mouseover",function(){b.newLink.line.setOptions({strokeWeight:6}),tooltip.show(b.newLink.sites[0].id.siteId+"-"+b.newLink.sites[1].id.siteId)}),google.maps.event.addListener(this.line,"mouseout",function(){b.newLink.line.setOptions({strokeWeight:3}),tooltip.hide()})}},toggle:Z,clear:function(){aa(this.sites[0]),aa(this.sites[1]),this.sites=[]}};var _=function(b){var c={path:google.maps.SymbolPath.CIRCLE,scale:12,strokeWeight:3,strokeColor:"#dd0000",fillColor:"#dd0000",fillOpacity:0,anchor:new google.maps.Point(0,0)},d=b.geoLocation.location.lat,f=b.geoLocation.location.lon,g={id:p++,index:b._index,siteId:b.id.siteId,isCluster:!1,mykey:e.encode(d,f,7),latitude:d,longitude:f,icon:c,showWindow:!1,selected:!0,toggle:h.markerToggle,options:{zIndex:0,draggable:!1,title:b.siteName}};a.mapObjects.selectedSites.models.push(g)},aa=function(b){var c=a.mapObjects.selectedSites.models.map(function(a){return a.id.siteId}).indexOf(b.id.siteId);a.mapObjects.selectedSites.models.splice(c,1)};a.setOverlayVisible=function(b,c){console.info("htLog:",a.mapObjects[b].visible),a.mapObjects[b].visible=c,"sites"===b&&a.mapObjects.sites.models.map(function(a){a.options.visible=c})};var ba=!1;Y(function(){})}]),"undefined"==typeof Number.prototype.toRad&&(Number.prototype.toRad=function(){return this*Math.PI/180}),app.factory("$networkMap",["$rootScope","$http","$compile","$query","$pathManager","geohash",function(a,b,c,d,e,f){var g,h=function(b,c,d,e){a.map.bounds={northeast:{latitude:c,longitude:e},southwest:{latitude:b,longitude:d}}},i=function(b){w.queryResult="Site: "+b.siteName,w.attributeValueChangeNotification("mapChanged"),a.infoWindowOpen=b.id.siteId;var d=new google.maps.LatLng(b.geoLocation.location.lat,b.geoLocation.location.lon),e="<site-details site-index=\"'"+g+"'\" site-id=\"'"+b.id.siteId+"'\"></site-details>",f=c(e)(a);w.handleInfoWindow(d,f[0]),a.isSearching=!1;var h=b.geoLocation.location;a.map.center={latitude:h.lat,longitude:h.lon},a.map.zoom<16&&(a.map.zoom=16)},j=function(a,b){var c={west:180,east:-180,north:-90,south:90};return a.lat<b.lat?(c.south=a.lat,c.north=b.lat):(c.south=b.lat,c.north=a.lat),a.lon<b.lon?(c.west=a.lon,c.east=b.lon):(c.west=b.lon,c.east=a.lon),c},k=function(b){w.queryResult="Sitelink: "+b.name,w.attributeValueChangeNotification("mapChanged");var d=b.geoLocationA.location,e=b.geoLocationB.location,f=j(d,e);h(f.south,f.north,f.west,f.east);var i=(d.lat+e.lat)/2,k=(d.lon+e.lon)/2,l=new google.maps.LatLng(i,k);w.infowindowOpen=b.id;var m="<site-link-details site-link-index=\"'";m+=g,m+="'\" site-link-id-low=\"'",m+=b.id.low,m+="'\" site-link-id-high=\"'",m+=b.id.high,m+="'\"></site-link-details>";var n=c(m)(a);w.handleInfoWindow(l,n[0]),a.isSearching=!1},l=function(b){w.queryResult="MWR link: "+b.id.mwrLinkId,w.attributeValueChangeNotification("mapChanged");var d=b.sa.loc.location,e=b.sb.loc.location,f=j(d,e);h(f.south,f.north,f.west,f.east);var i=(d.lat+e.lat)/2,k=(d.lon+e.lon)/2,l=new google.maps.LatLng(i,k);w.infowindowOpen=b.id.mwrLinkId;var m="<site-link-details site-link-index=\"'";m+=g,m+="'\" site-link-id-low=\"'",m+=b.id.siteLinkId.low,m+="'\" site-link-id-high=\"'",m+=b.id.siteLinkId.high,m+="'\"></site-link-details>";var n=c(m)(a);w.handleInfoWindow(l,n[0]),a.isSearching=!1},m={path:google.maps.SymbolPath.FORWARD_OPEN_ARROW,strokeOpacity:1,scale:4},n={path:"M 0,-2 0,2",strokeOpacity:1,scale:6},o={path:"M 0,0.5 0,-0.5",strokeOpacity:1,scale:6},p={solid:{icons:[{icon:m,offset:"100%"}],stroke:{color:"#00dd00",weight:6,opacity:1},strokeOpacity:1,editable:!1,draggable:!1,geodesic:!0,visible:!0,zIndex:30,title:"todo"},dashed:{icons:[{icon:n,offset:"0%",repeat:"50px"},{icon:m,offset:"100%"}],stroke:{color:"#00ff00",weight:6,opacity:.1},strokeOpacity:0,editable:!1,draggable:!1,geodesic:!0,visible:!0,zIndex:30,title:"todo"},dotted:{icons:[{icon:o,offset:"0%",repeat:"20px"},{icon:m,offset:"100%"}],stroke:{color:"#dddd00",weight:6,opacity:.1},strokeOpacity:0,editable:!1,draggable:!1,geodesic:!0,visible:!0,zIndex:30,title:"todo"}},q=function(a,b){var c="solid";c="required"===a.status?"solid":"planned"===a.status?"dashed":"dotted";var d=p[c];return d.id=a.id,d.index=g,d.path=a.sitePath,b(d)},r=function(b){var c=180,d=-180,f=-90,i=90,j=b.map(function(b){var j=e.getPath(b);return w.getSitesByIds(g,j,function(e){var g={};e.map(function(a){var b=a._source.geoLocation.location;c>b.lon&&(c=b.lon),b.lon>d&&(d=b.lon),i>b.lat&&(i=b.lat),b.lat>f&&(f=b.lat),g[a._source.id.siteId]={latitude:b.lat,longitude:b.lon}});var k={};k.sitePath=[],j.map(function(a){g[a]&&k.sitePath.push(g[a])}),k.status="unknown","x:akta"===b._source.ePlanner.planner?k.status="required":b._source.ePlanner.planner.startsWith("autor")?k.status="proposed":k.status="planned",k.id="path_"+b._source.id,q(k,function(b){a.mapObjects.paths.models.push(b)}),console.info("before",i,f,c,d),h(i,f,c,d)}),b._source.id});w.queryResult="Paths: "+j.join(", "),w.attributeValueChangeNotification("mapChanged")},s=function(b){w.queryResult=b.display_name,w.attributeValueChangeNotification("mapChanged");var c={northeast:{latitude:b.boundingbox[1],longitude:b.boundingbox[3]},southwest:{latitude:b.boundingbox[0],longitude:b.boundingbox[2]}};a.map.bounds=c},t=function(a){for(var b=a.southwest.latitude,c=a.southwest.longitude,d=a.northeast.latitude,e=a.northeast.longitude,g=1,h=[],i=!0,j=3;i;){g++,h=f.bboxes(b,c,d,e,g);var k=f.encode(b,c,g),l=f.neighbor(k,[0,j]),m=f.neighbor(k,[j,0]);i=(k===l||k===m||-1===h.indexOf(l)||-1===h.indexOf(m))&&h.length<33&&h.length>0}return g},u=function(a,b,c){var d="/db/";return d+=a,d+="/",d+=b,d+="/",d+=c},v={forMap:{exclude:["networkElements","bandwidth14","siteSource"]}},w={};return w.statistics={sites:{label:"SITES",count:0,displayed:0},siteLinks:{label:"SITELINKS",count:0,displayed:0}},w.options={},w.isWorking=!1,w.setOptions=function(a){this.options=a,this.attributeValueChangeNotification("mapChanged")},w.getNewRequest=function(a,b,c){return{method:a,url:b,headers:{"Content-Type":"application/json"},data:c}},w.getBounds=function(a){var c={from:0,size:0,query:{match_all:{}},partial_fields:v,aggs:{west:{min:{field:"lon"}},east:{max:{field:"lon"}},south:{min:{field:"lat"}},north:{max:{field:"lat"}}}},d=u(g,"site","_search"),e=w.getNewRequest("POST",d,c);w.setWorking(!0),b(e).success(function(b,c){w.setWorking(!1);var d={northeast:{latitude:b.aggregations.north.value,longitude:b.aggregations.east.value},southwest:{latitude:b.aggregations.south.value,longitude:b.aggregations.west.value}};a(d)}).error(function(b,c){console.info("htLog: Error while requesting bounds. ",b,c),a(null)})},w.getClusters=function(a,c){var d=t(a),e=f.encode(a.northeast.latitude,a.southwest.longitude,d),h=f.decode_bbox(e),i=f.encode(a.southwest.latitude,a.northeast.longitude,d),j=f.decode_bbox(i),k={from:0,size:0,query:{filtered:{query:{match_all:{}},filter:{geo_bounding_box:{"geoLocation.location":{top_left:{lat:h[2],lon:h[1]},bottom_right:{lat:j[0],lon:j[3]}}}}}},partial_fields:v,aggs:{clusters:{geohash_grid:{field:"location",precision:d}}}},l=u(g,"site","_search"),m=w.getNewRequest("POST",l,k);w.setWorking(!0),b(m).success(function(a,b){w.setWorking(!1),c(a.aggregations.clusters.buckets,d)}).error(function(a,b){console.info("htLog: Error while requesting clusters. ",a,b),c(null,d)})},w.getAltitude=function(a,c,d){var e="https://open.mapquestapi.com/elevation/v1/profile";e+="?key=Fmjtd%7Cluu8296z2h%2C25%3Do5-9w1xqu",e+="&shapeFormat=raw",e+="&latLngCollection="+a+","+c,b.get(e).success(function(a){return d(null,a.elevationProfile[0].height)}).error(function(a,b){return d("Error! "+a+" ("+b+")",null)})},w.getSiteById=function(a,c,d){var e={from:0,size:1,query:{match:{siteId:c}}},f=u(a,"site","_search"),g=w.getNewRequest("POST",f,e);w.setWorking(!0),b(g).success(function(a,b){w.setWorking(!1),d(a.hits.hits[0])}).error(function(a,b){console.info("htLog: Error while requesting site ("+c+").",a,b),d(null)})},w.removeSite=function(a,c,d){w.setWorking(!0);var e={method:"GET",url:"/api/delete/site/"+c,headers:{"Content-Type":"application/json"}};b(e).success(function(a,b){w.setWorking(!1),d(null,a)}).error(function(a,b){console.info("htLog: ",a,b),w.setWorking(!1),d(a,null)})},w.removeSiteLink=function(a,c,d){w.setWorking(!0);var e={method:"GET",url:"/api/delete/loslink/"+c.high+"/"+c.low,headers:{"Content-Type":"application/json"}};b(e).success(function(a,b){w.setWorking(!1),d(null,a)}).error(function(b,e){console.info("error","remove",a,c,b,e),w.setWorking(!1),d(b,null)})},w.getSites=function(a,c){var d={from:0,size:w.statistics.sites.count,query:{filtered:{query:{match_all:{}},filter:{geo_bounding_box:{"geoLocation.location":{top_left:{lat:a.northeast.latitude,lon:a.southwest.longitude},bottom_right:{lat:a.southwest.latitude,lon:a.northeast.longitude}}}}}},partial_fields:v},e=u(g,"site","_search"),f=w.getNewRequest("POST",e,d);w.setWorking(!0),b(f).success(function(a,b){w.setWorking(!1),c(a.hits.hits)}).error(function(a,b){console.info("htLog: Error while requesting clusters. ",a,b),c(null)})},w.getSiteLinksByBounds=function(a,c){if(void 0===a)return c([]);var d=a.southwest.longitude,e=a.southwest.latitude,f=a.northeast.longitude,g=a.northeast.latitude,h=["/api","loslinks",d,e,f,g,50].join("/"),i=w.getNewRequest("POST",h,void 0);w.setWorking(!0),b(i).success(function(a,b){return w.setWorking(!1),c(a)}).error(function(a,b){return console.info("htLog: Request for sitelinks in viewport failed.",JSON.stringify(i),a,b),c([])})},w.getDetailedNetworkElements=function(a,c,d){var e={from:0,size:999,query:{term:{siteRef:c}}},f=u(a,"networkelement","_search"),g=w.getNewRequest("POST",f,e);w.setWorking(!0),b(g).success(function(a,b){w.setWorking(!1),d(a.hits.hits)}).error(function(a,b){console.info("htLog: Request for networkElements failed.",a,b),d([])})},w.getSiteLinksBySiteIds=function(a,c,d){if(0===c.length)return w.statistics.siteLinks.displayed=0,d([]);var e={from:0,size:99999,query:{filtered:{query:{match_all:{}},filter:{or:[{terms:{siteARef:c}},{terms:{siteBRef:c}}]}}}},f=u(a,"sitelink","_search"),g=w.getNewRequest("POST",f,e);w.setWorking(!0),b(g).success(function(a,b){w.setWorking(!1),w.statistics.siteLinks.displayed=a.hits.hits.length,d(a.hits.hits)}).error(function(a,b){console.info("htLog: Error while requesting siteLinks by siteIds. ",a,b),d([])})},w.getSitesOfLink=function(a,c){var d={method:"POST",url:u(a._index,"site","_search"),headers:{"Content-Type":"application/json"},data:{from:0,size:2,query:{terms:{"id.siteId":[a._source.id.high,a._source.id.low],minimum_should_match:1}}}};b(d).success(function(a,b){c(a.hits.hits)}).error(function(a,b){console.info("htLog: Request for sites of siteLink failed.",a,b),c({})})},w.getSiteLink=function(a,c,d){var e={from:0,size:1,query:{filtered:{query:{match_all:{}},filter:{and:[{term:{"id.high":c.high}},{term:{"id.low":c.low}}]}}}},f=u(a,"sitelink","_search"),g=w.getNewRequest("POST",f,e);w.setWorking(!0),b(g).success(function(a,b){w.setWorking(!1),d(a.hits.hits[0])}).error(function(a,b){console.info("htLog: Error while requesting siteLink by siteLinkId. ",a,b),d(null)})},w.getSitesByGeoHashes=function(a,c){if(0===a.length)return w.statistics.sites.displayed=0,c([]);var d=[];a.map(function(a){var b={geohash_cell:{"geoLocation.location":a}};d.push(b)});var e={from:0,size:w.statistics.sites.count,query:{filtered:{query:{match_all:{}},filter:{or:d}}},partial_fields:v},f=u(g,"site","_search"),h=w.getNewRequest("POST",f,e);w.setWorking(!0),b(h).success(function(a,b){w.setWorking(!1),w.statistics.sites.displayed=a.hits.hits.length,c(a.hits.hits)}).error(function(a,b){console.info("htLog: Error while requesting documents by geoHashes. ",a,b),c(null)})},w.googleMap=function(){return a.map.control.getGMap()},w.infowindow=new google.maps.InfoWindow,w.setMarker=function(a){this.marker=a},w.getInfowindow=function(){return this.infowindow},w.icon={path:google.maps.SymbolPath.CIRCLE,scale:10,strokeWeight:3,strokeColor:"#dd0000",fillColor:"#dd0000",fillOpacity:1,anchor:new google.maps.Point(0,0)},w.getSitesByIds=function(a,c,d){if(0===c.length)return d([]);var e={from:0,size:99999,query:{terms:{siteId:c}}},f=u(a,"site","_search"),g=w.getNewRequest("POST",f,e);w.setWorking(!0),b(g).success(function(a,b){w.setWorking(!1),d(a.hits.hits)}).error(function(a,b){d(null)})},w.getStatistics=function(a){var c={from:0,size:0,query:{match_all:{}},aggs:{west:{min:{field:"geoLocation.location.lon"}},east:{max:{field:"geoLocation.location.lon"}},south:{min:{field:"geoLocation.location.lat"}},north:{max:{field:"geoLocation.location.lat"}}}},d=u(g,"site","_search"),e=w.getNewRequest("POST",d,c);w.setWorking(!0),b(e).success(function(c,d){w.setWorking(!1),w.network={bounds:{northeast:{latitude:c.aggregations.north.value,longitude:c.aggregations.east.value},southwest:{latitude:c.aggregations.south.value,longitude:c.aggregations.west.value}}},w.statistics.sites.count=c.hits.total;var e=u(g,"sitelink","_count"),f=w.getNewRequest("GET",e,c);w.setWorking(!0),b(f).success(function(b,c){return w.setWorking(!1),w.statistics.siteLinks.count=b.count,a(null,w.statistics)})}).error(function(b,c){return console.info("htLog: this must not happen!",b,c),a("Server not reachable? Please check internet connectivity. ("+c+")",null)})},w.getDbIndex=function(a){w.setWorking(!0);var c="/api/server",d=w.getNewRequest("GET",c);b(d).success(function(b,c){return w.setWorking(!1),g=b.network_index,a(g)}).error(function(b,c){return console.info("htLog: ",b,c),a(g)})},w.setWorking=function(a){this.isWorking=a,this.attributeValueChangeNotification("mapChanged")},w.setMap=function(a){this.map=a,this.attributeValueChangeNotification("mapChanged")},w.attributeValueChangeNotification=function(b){a.$broadcast(b)},w.attributeValueChangeListener=function(b){a.$on("mapChanged",b);
},w.getDbIndex(function(a){g=a}),w.handleQueryResult=function(b){if("OK"===b.result.status&&b.result.data.hits.hits.length>0){var c=b.result.data.hits.hits[0]._type;switch(c){case"site":i(b.result.data.hits.hits[0]._source);break;case"sitelink":k(b.result.data.hits.hits[0]._source);break;case"mwrlinkrevisionvariant":l(b.result.data.hits.hits[0]._source);break;case"path":r(b.result.data.hits.hits)}}else{var e=b.request;e.objectType="nominatim",d.query(e,function(b){"OK"===b.result.status&&b.result.data.length>0?s(b.result.data[0]):a.queryResult="Not found!",a.isSearching=!1})}},w.handleInfoWindow=function(a,b){this.infowindow.setContent(b),this.infowindow.setPosition(a),this.infowindow.open(this.googleMap())},w.getDensity=function(a,c){var d=["/ux/modules/density/"+a+".json"].join("");b.get(d).success(function(a){c(a)}).error(function(a,b){console.info("htLog:",a,b),c([])})},w}]),"undefined"==typeof Number.prototype.toRad&&(Number.prototype.toRad=function(){return this*Math.PI/180}),app.factory("$htCluster",["$http","$networkMap","profileService","geohash",function(a,b,c,d){var e=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=6371,g=c.toRad(),h=e.toRad(),i=(e-c).toRad(),j=(d-b).toRad(),k=Math.sin(i/2)*Math.sin(i/2)+Math.cos(g)*Math.cos(h)*Math.sin(j/2)*Math.sin(j/2),l=2*Math.atan2(Math.sqrt(k),Math.sqrt(1-k)),m=f*l;return m},f=function(a,b,c){return{method:a,url:b,headers:{"Content-Type":"application/json"},data:c}},g=function(a){var b=e(a);return Math.round(b/30)},h=function(a){var b=a.southwest.longitude,c=a.southwest.latitude,d=a.northeast.longitude,e=a.northeast.latitude;return[b,c,d,e]},i=["0 0","4 8","7 8","11 8","15 8","19 8"],j=[new google.maps.Point(0,0),new google.maps.Point(26,26),new google.maps.Point(28,28),new google.maps.Point(33,33),new google.maps.Point(39,39),new google.maps.Point(45,45)],k=function(a){var b=a.toString().length;return b>5&&(b=5),1>b&&(b=1),b},l={};return l.createDistanceClusterMarker=function(a,b,c){var e={type:"cluster",status:"normal"},f=l.getDistanceClusterIcon(a,e),g=a.center.location.lat,h=a.center.location.lon,j=k(a.markerCount),m={id:b,isCluster:!0,mykey:d.encode(g,h,7),latitude:g,longitude:h,icon:f,showWindow:!1,options:{zIndex:10,draggable:!1,labelContent:a.markerCount,labelAnchor:i[j],labelClass:"labelClass"}};return c(m)},l.getDistanceClusterIcon=function(a,b){var c=k(a.markerCount),d="m"+c+".png",e="/ux/modules/networkMap/images/"+d;return{url:e,anchor:j[c]}},l.getMapObjects=function(c,d,e,i){for(var j=h(c),k=g(j),l="/api/siteclusters/",m=0;m<j.length;m++)l+=j[m]+"/";l+=k+"/",l+=d+"/",l+=e;var n=f("POST",l);a(n).success(function(a){return b.setWorking(!1),i(a.markerClusters,a.remaining)}).error(function(a){return i([],[])})},l}]),app.factory("$mapOverlay",function(){function a(a,b,c,d){this.tileSize=a,this.map=b,this.minZoom=c,this.maxZoom=d}a.prototype.getTile=function(a,b,c){var d=c.createElement("div");if(b>this.maxZoom)return d;var e="tile-";10>b&&(e+="0"),e=e+b+"-"+a.x+"-"+a.y+".png";var f=!1;if(f){var g=1<<b,h=a.x*this.tileSize.width/g,i=a.y*this.tileSize.height/g,j=this.map.getProjection().fromPointToLatLng(new google.maps.Point(h,i));h*=g,i*=g;var k="<p>";k+='<table style="border-collapse: separate; border-spacing: 5px;">',k+="<tr>",k+='<td class="text-right"><span>',k+="tileId: ",k+="</span></td>",k+="<td><span>",k+=b+"-"+a.x+"-"+a.y,k+="</span></td>",k+="</tr>",k+="<tr>",k+='<td class="text-right"><span>',k+="pixel: ",k+="</span></td>",k+="<td><span>",k+=h+", "+i,k+="</span></td>",k+="</tr>",k+="<tr>",k+='<td class="text-right"><span>',k+="latLon: ",k+="</span></td>",k+="<td><span>",k+=j.lat().toFixed(6)+", "+j.lng().toFixed(6),k+="</span></td>",k+="</tr>",k+="</table>",k+="</p>",d.innerHTML=k,d.style.color="#EEEEEE",d.style.fontSize="10",d.style.borderStyle="solid",d.style.borderWidth="1px",d.style.borderColor="#AAAAAA"}return d.style.width=this.tileSize.width+"px",d.style.height=this.tileSize.height+"px",d.style.backgroundImage="url('/tile/"+b+"/"+a.x+"/"+a.y+"')",d};var b={};return b.getOverlay=function(b,c,d){var e=256;return new a(new google.maps.Size(e,e),b,c,d)},b}),app.factory("siteMarkerService",["$rootScope","geohash","profileService",function(a,b,c){var d=function(a,b){var d=0;return d=parseFloat(c.profile[b.type][b.status].fill.opacity)},e=function(a){var b=f.shape.types.indexOf(a);switch(b){case 0:return"M-1,0a1,1 0 1,0 2,0a1,1 0 1,0 -2,0";case 1:return 0;case 2:return"M0,0 L0,-1";default:for(var c=b,d="z";c;){c--;var e=2*Math.PI/b*c,g=Math.round(100*Math.cos(e))/100,h=Math.round(100*Math.sin(e))/100;d=0===c?"M"+g+","+h+" "+d:"L"+g+","+h+" "+d}return d="M0,0 "+d}return 0},f={};return f.shape={types:["circle","dot","dash","triangle","square","pentagon","hexagon","heptagon","octagon"]},f.init=function(a){c.getProfileData(a,function(a,b){})},f.getIcon=function(a,b){var f=c.profile[b.type].shape,g=c.profile[b.type][b.status],h=parseInt(f.scale),i=parseInt(f.rotation);a.isAggregator&&(h=c.profile.siteIsAggregator.shape.scale,i=c.profile.siteIsAggregator.shape.rotation);var j={urban:{from:1,color:"#FF4500"},suburban:{from:.3,to:1,color:"#FFA500"},rural:{from:0,to:.3,color:"#FFD700"}},k=g.stroke.color,l=g.fill.color;if(a.geoLocation.sourceGeo&&a.geoLocation.sourceGeo.indexOf("DAYLIGHT")>-1&&(k="#00FF00",l="#00FF00"),a.densityBsPerSKm){var m,n=Object.keys(j);n.map(function(b){j[b].from&&j[b].to?j[b].from<=a.densityBsPerSKm&&a.densityBsPerSKm<j[b].to&&(m=b):j[b].from?j[b].from<=a.densityBsPerSKm&&(m=b):a.densityBsPerSKm<j[b].to&&(m=b)}),k=j[m].color,l=j[m].color}return{path:e(f.type),scale:h,rotation:i,strokeWeight:parseInt(g.stroke.width),strokeColor:k,strokeOpacity:parseFloat(g.stroke.opacity),fillColor:l,fillOpacity:d(a,b),anchor:{x:0,y:0}}},f.getCircle=function(a,b,c,d){return d({id:a,center:{latitude:b.geoLocation.location.lat,longitude:b.geoLocation.location.lon},radius:c,stroke:{color:"#EEEEEE",weight:1,opacity:1},fill:{color:"#EEEEEE",opacity:.1},geodesic:!0,draggable:!1,clickable:!1,editable:!1,visible:!0,control:{}})},f.createSiteMarker=function(a,d,e,g){var h=d.siteLinks.length;"linkTable"===d.siteSource&&(h=0);var i,j,k=function(a){return a.isAggregator?a.isAggregator:a.siteExtensions?(i=a.siteExtensions.fiberPlanDate,j=a.siteExtensions.fiberActualDate,a.siteExtensions.fiberPlanDate&&(e.type="siteHasFiberPlanned"),a.siteExtensions.fiberActualDate&&(e.type="siteHasFiber"),a.siteExtensions.concentrator):!1},l={id:{siteId:d.id.siteId},siteName:d.siteName,geoLocation:d.geoLocation,siteLinks:h,densityBsPerSKm:void 0,isAggregator:k(d),fiberPlanDate:i,fiberActualDate:j},m=f.getIcon(l,e),n=d.geoLocation.location.lat,o=d.geoLocation.location.lon,p={id:a,site:l,isCluster:!1,mykey:b.encode(n,o,5),type:e.type,latitude:n,longitude:o,icon:m,showWindow:!1,selected:!1,toggle:f.markerToggle,options:{visible:e.visible,zIndex:c.profile[e.type].shape.zIndex,draggable:-1===d.id.siteId,title:d.siteName.toString()}};return g(p)},f}]),app.controller("mapControlCtrl",["$rootScope","$scope","$compile","$http","$query","$networkMap",function(a,b,c,d,e,f){f.attributeValueChangeListener(function(){b.map=f.map,b.options=f.options,b.statistics=f.statistics,b.isWorking=f.isWorking,b.queryResult=f.queryResult});var g=function(){return void 0!==h?h:void f.getDbIndex(function(a){return h=a})},h=g();b.refresh=function(){},angular.extend(b,{showControls:!0,controlClick:function(){b.showControls=!b.showControls},oneAtATime:!0,query:"",panTo:function(a){b.map.center={latitude:a[0],longitude:a[1]},b.map.zoom=12,f.setMap(b.map)},groups:[{title:"Search",templateUrl:"/ux/modules/networkMap/templates/search.html",open:!1},{title:"Cities",templateUrl:"/ux/modules/networkMap/templates/cities.html",open:!1},{title:"Geographical Coordinates",templateUrl:"/ux/modules/networkMap/templates/geographicalCoordinates.html",open:!1},{title:"Layer",templateUrl:"/ux/modules/networkMap/templates/layer.html",open:!1},{title:"Statistics",templateUrl:"/ux/modules/networkMap/templates/statistics.html",open:!1},{title:"Legend",templateUrl:"/ux/modules/networkMap/templates/legend.html",open:!1}],cities:[{name:"Berlin",latlng:[52.518611,13.408333]},{name:"Hamburg",latlng:[53.550556,9.993333]},{name:"München",latlng:[48.137222,11.575556]},{name:"Köln",latlng:[50.938056,6.956944]},{name:"Frankfurt am Main",latlng:[50.110556,8.682222]},{name:"Stuttgart",latlng:[48.775556,9.182778]},{name:"Düsseldorf",latlng:[51.225556,6.782778]},{name:"Dortmund",latlng:[51.514167,7.463889]},{name:"Essen",latlng:[51.458069,7.014761]},{name:"Bremen",latlng:[53.075878,8.807311]},{name:"Leipzig",latlng:[51.340333,12.37475]},{name:"Dresden",latlng:[51.049259,13.73836]},{name:"Hannover",latlng:[52.374444,9.738611]},{name:"Nürberg",latlng:[49.455556,11.078611]},{name:"Duisburg",latlng:[51.435147,6.762692]}],legend:{data:{"Provider A":{label:"ProviderA",color:"#0CF",colors:{osm:"#0000FF",satellit:"#0CF"}},TELEFONICA:{label:"Leased",color:"#0CF",colors:{osm:"#0000FF",satellit:"#0CF"}},EPLUS:{label:"Provider1",color:"#0F3",colors:{osm:"#008800",satellit:"#0F3"}},MIX:{label:"Mix",color:"#00FFFF",colors:{osm:"#00AAAA",satellit:"#00FFFF"}}}},layers:{baseLayers:{hybrid:{name:"Satellite and Roads"},terrain:{name:"Terrain"},roadmap:{name:"Roadmap"},satellite:{name:"Satellite"}},overlays:{sites:{name:"SITES",type:"group",visible:!0},siteLinks:{name:"SITELINKS",type:"group",visible:!0},paths:{name:"PATHS",type:"group",visible:!0},urban:{name:"URBAN",type:"group",visible:!1},suburban:{name:"SUBURBAN",type:"group",visible:!1}},changeLayer:function(a){b.options.mapTypeId=a,b.map.control.getGMap().setOptions(b.options)}},map:f.map,options:f.options,statistics:f.statistics}),a.isWorking=!1,a.isSearching=!1,b.addMarker=function(){var a="#DD0000",d={path:google.maps.SymbolPath.CIRCLE,scale:10,strokeWeight:3,strokeColor:a,fillColor:a,fillOpacity:.5,anchor:new google.maps.Point(0,0)},e=new google.maps.Marker({position:new google.maps.LatLng(b.map.center.latitude,b.map.center.longitude),map:b.map.control.getGMap(),icon:d,zIndex:20,draggable:!0});f.setMarker(e);var g=function(a){var b=Object.keys(a),c=Math.round(1e6*a[b[0]])/1e6,d=Math.round(1e6*a[b[1]])/1e6,e=c;return e+=" : ",e+=d};google.maps.event.addListener(e,"dragend",function(){tooltip.show(g(e.position))}),google.maps.event.addListener(e,"click",function(a){if(null===b.infoWindowOpen||"undefined"===b.infoWindowOpen){b.infoWindowOpen="newSite";var d=Object.keys(e.position),g=Math.round(1e6*e.position[d[0]])/1e6,h=Math.round(1e6*e.position[d[1]])/1e6,i="<new-site lat="+g+" lng="+h+"></new-site>",j=c(i)(b);f.handleInfoWindow(a.latLng,j[0])}else b.infoWindowOpen=null,f.infowindow.close()}),google.maps.event.addListener(e,"mouseover",function(){tooltip.show(g(e.position))}),google.maps.event.addListener(e,"mouseout",function(){tooltip.hide()})},b.submit=function(){if(b.query=this.query,b.query){a.isSearching=!0;var c={};c.dbIndex=g(),c.objectType="database",c.value=b.query,e.query(c,function(a){f.handleQueryResult(a)})}},b.$watch("groups[4].open",function(a){a&&(f.statistics=b.statistics)}),b.$watch("layers.overlays.sites.visible",function(b,c){void 0!==b&&void 0!==c&&b!==c&&a.setOverlayVisible("sites",b)}),b.$watch("layers.overlays.siteLinks.visible",function(b,c){void 0!==b&&void 0!==c&&b!==c&&a.setOverlayVisible("siteLinks",b)}),b.$watch("layers.overlays.paths.visible",function(b,c){void 0!==b&&void 0!==c&&b!==c&&a.setOverlayVisible("paths",b)}),b.$watch("layers.overlays.urban.visible",function(b,c){void 0!==b&&void 0!==c&&b!==c&&a.setOverlayVisible("urban",b)}),b.$watch("layers.overlays.suburban.visible",function(b,c){void 0!==b&&void 0!==c&&b!==c&&a.setOverlayVisible("suburban",b)})}]),app.directive("siteDetails",function(){return{restrict:"E",templateUrl:"/ux/modules/directives/siteDetails/siteDetails.html",scope:{siteIndex:"=",siteId:"="},controller:["$rootScope","$scope","$networkMap",function(a,b,c){b.status={message:"Searching...",type:"warning",isWorking:!0},b.removeSite=function(){a.removeSite(b.siteIndex,b.siteId)},b.showNewLinkButton=!1,void 0!==a.newLink&&(b.showNewLinkButton=!0,b.createNewLinkMode=a.newLink.mode(b.siteId),b.toggleCreateNewLinkMode=function(){b.createNewLinkMode=a.newLink.toggle(b.site)}),b.$watch("siteId",function(a){void 0!==a&&0!==a&&c.getSiteById(b.siteIndex,a,function(d){if(d){b.site=d._source,b.site.isFiberPoP=function(){if(d.planta14){if(-1!==b.site.planta14.indexOf("Fib"))return"2014";if(-1!==b.site.ultima15.indexOf("Fib"))return"2015";if(-1!==b.site.externa17.indexOf("Fib"))return"2017"}return"false"};var e=[];e.push(d._source.id.siteId),c.getSiteLinksBySiteIds(d._index,e,function(a){b.detailedSiteLinks=a}),c.getDetailedNetworkElements(d._index,d._source.id.siteId,function(a){b.detailedNetworkElements=a}),b.status.message=void 0,b.status.type="success",b.status.isWorking=!1}else b.status.message="Site '"+a+"' not found!",b.status.type="danger",b.status.isWorking=!1})})}]}}),app.directive("newMwrLink",["$networkMap","alertService",function(a,b){return{restrict:"E",templateUrl:"/ux/modules/directives/newMwrLink/newMwrLink.html",scope:{dbIndex:"@dbIndex",siteIdA:"=",siteIdB:"=",revisionType:"="},controller:["$rootScope","$scope","$http",function(c,d,e){b.setMessage(["CREATING","CREATE_SUCCESS","CREATE_FAILED"]),d.mpA="new",a.getSiteById(d.dbIndex,d.siteIdA,function(a){d.siteA=a,d.siteA._source.antennamountingpositions.length>0&&(d.mpA="item0")}),d.mpB="new",a.getSiteById(d.dbIndex,d.siteIdB,function(a){d.siteB=a,d.siteB._source.antennamountingpositions.length>0&&(d.mpB="item0")}),d.cancelMwrLink=function(){c.cancelMwrLink({dbIndex:d.dbIndex,siteLinkId:{low:d.siteIdA,high:d.siteIdB}})},d.createMwrLink=function(){d.status=b.processing();var a={method:"GET",url:"/api/create/MWRLINKREVISIONVARIANT/"+d.siteIdA+"/"+d.siteIdB,headers:{"Content-Type":"application/json"}};e(a).success(function(a){d.status=b.success(),c.mwrLinkCreated({dbIndex:d.dbIndex,siteLinkId:{low:d.siteIdA,high:d.siteIdB}},a)}).error(function(a,c){d.status=b.failed()})}}]}}]),app.directive("newSite",["$rootScope","$networkMap","alertService",function(a,b,c){return{restrict:"E",templateUrl:"/ux/modules/directives/newSite/newSite.html",scope:{name:"=",lat:"=",lon:"="},controller:["$scope","$http",function(d,e){c.setMessage(["CREATING","CREATE_SUCCESS","CREATE_FAILED"]),d.newSite={siteName:"newSite",geoLocation:{location:{lat:0,lon:0},amslGrd:100}},d.cancelSite=function(){a.cancelSite()},d.createSite=function(){d.status=c.processing();var b={method:"GET",url:"/api/create/site/"+d.newSite.geoLocation.location.lat+"/"+d.newSite.geoLocation.location.lon+"/"+d.newSite.geoLocation.amslGrd,headers:{"Content-Type":"application/json"}};e(b).success(function(b){d.status=c.success(),a.createNewSiteOnMap(b,function(){})}).error(function(a,b){d.status=c.failed()})};var f=function(){d.newSite.siteName=d.name,d.newSite.geoLocation.location.lat=d.lat,d.newSite.geoLocation.location.lon=d.lon,b.getAltitude(d.lat,d.lon,function(a,b){d.newSite.geoLocation.amslGrd=b})};f()}]}}]),app.filter("nominus",function(){return function(a){return a?a.replace(/-/g,""):""}}),app.directive("siteLinkDetails",function(){"use strict";return{restrict:"E",templateUrl:"/ux/modules/directives/siteLinkDetails/siteLinkDetails.html",scope:{siteLinkIndex:"=",siteLinkIdLow:"=",siteLinkIdHigh:"="},controller:["$rootScope","$scope","$http","$networkMap",function(a,b,c,d){b.status={message:"Searching...",type:"warning",isWorking:!0},b.showNewMwrLinkButton=!1,void 0!==a.newLink&&(b.showNewMwrLinkButton=!0),b.getSiteLinkId=function(){return{low:b.siteLinkIdLow,high:b.siteLinkIdHigh}},b.removeSiteLink=function(){a.removeSiteLink(b.siteLinkIndex,b.getSiteLinkId())},b.createMwrLink=function(){a.createMwrLink(b.siteLinkIndex,b.getSiteLinkId())};var e=function(){d.getSiteLink(b.siteLinkIndex,b.getSiteLinkId(),function(a){b.siteLink=a,b.status.message=void 0,b.status.type="success",b.status.isWorking=!1,d.getSitesOfLink(b.siteLink,function(a){b.sites=a})})};e()}]}}),app.directive("sitePathDetails",function(){"use strict";return{restrict:"E",templateUrl:"/ux/modules/directives/sitePathDetails/sitePathDetails.html",scope:{dbIndex:"=",sitePathId:"="},controller:["$rootScope","$scope","$http","$networkMap","$pathDetails",function(a,b,c,d,e){b.status={message:"Searching...",type:"warning",isWorking:!0};var f=b.sitePathId;f.startsWith("path_")&&(f=b.sitePathId.substring(5)),e.getPath(b.dbIndex,f,function(a){b.status.isWorking=!1,a?(b.status.message=void 0,b.status.type="success",b.path={model:a._source}):(b.status.message="PATH_NOT_FOUND",b.status.type="danger",b.path={})})}]}}),app.directive("newSiteLink",["alertService",function(a){return{restrict:"E",templateUrl:"/ux/modules/directives/newSiteLink/newSiteLink.html",scope:{siteIdA:"=",siteIdB:"="},controller:["$rootScope","$scope","$http",function(b,c,d){a.setMessage(["CREATING","CREATE_SUCCESS","CREATE_FAILED"]),c.sites=[],c.cancelLosLink=function(){b.cancelSiteLink()},c.createLosLink=function(){c.status=a.processing();var e={method:"GET",url:"/api/create/loslink/"+c.sites[0]+"/"+c.sites[1],headers:{"Content-Type":"application/json"}};d(e).success(function(d){c.status=a.success(),b.createNewSitelinkInDB(d.loslink,function(){})}).error(function(b,d){console.info("htLog:",b,d),c.status=a.failed()})};var e=function(){c.sites=[c.siteIdA,c.siteIdB]};e(),c.$watch("siteIdA",function(a,b){a!==b&&e()}),c.$watch("siteIdB",function(a,b){a!==b&&e()})}]}}]);var htRevisionStatus=angular.module("htRevisionStatus",["ui.bootstrap","base64","htLogin","alert","translate"]);htRevisionStatus.filter("username",function(){return function(a){a=a||"";var b=a,c=b.indexOf("@");return c>-1&&(b=b.substring(0,c)),b}}),htRevisionStatus.config(["$stateProvider",function(a){"use strict";a.state("revisionStatus",{url:"/revisionStatus/:index/:high/:low/:mwrLinkId/:revision",templateUrl:"modules/revisionStatus/revisionStatus.html",controller:["$rootScope","$scope","$filter","$uibModal","$base64","$stateParams","$mwrLink","$revisionStatus","authenticationService","alertService","$header",function(a,b,c,d,e,f,g,h,i,j,k){j.setMessage(["LOADING","SUCCESS","FAILED"]),k.setStatus(j.processing());var l=!1,m={mwrLinkLoaded:!1,revisionStatesLoaded:!1,revisionTypesLoaded:!1,getInitStatus:function(){return this.mwrLinkLoaded&&this.revisionStatesLoaded&&this.revisionTypesLoaded}},n=function(){var a=[];b.revisionStates.map(function(b){var c={revisionState:b,required:null,plan:null,actual:null,planner:null,comment:null};a.push(c)}),void 0!==b.mwrLink.lifeCycle.revisionFlags&&b.mwrLink.lifeCycle.revisionFlags.map(function(b){a.map(function(a){b.revisionState.id===a.revisionState.id&&(a.required=b.required,a.plan=b.plan,a.actual=b.actual,a.planner=b.planner,a.comment=b.comment)})}),b.tableModel=a};b.dbIndex=f.index,b.siteLinkIdLow=f.low,b.siteLinkIdHigh=f.high,b.mwrLinkId=f.mwrLinkId,b.revision=f.revision,b.displayId=f.high+"-"+f.low+"-"+f.mwrLinkId+"-"+f.revision,a.title="("+b.displayId+") htRevisionStatus";var o=i.getProfileName();b.username=i.getUsername(o),b.revisionStatus={},b.editRow=function(a){b.selectedRow={},b.tableModel.map(function(c){c.revisionState.id===a&&(b.selectedRow=JSON.parse(JSON.stringify(c)))}),(null===b.selectedRow.planner||void 0===b.selectedRow.planner)&&(b.selectedRow.planner=b.username),null!==b.selectedRow.required&&(b.selectedRow.required=new Date(b.selectedRow.required)),null!==b.selectedRow.plan&&(b.selectedRow.plan=new Date(b.selectedRow.plan)),null!==b.selectedRow.actual&&(b.selectedRow.actual=new Date(b.selectedRow.actual));var c=d.open({animation:b.animationsEnabled,templateUrl:"/ux/modules/revisionStatus/revisionStatus.modify.html",controller:"ModifyCtrl",size:"lg",resolve:{selectedRow:function(){return b.selectedRow}}});c.result.then(function(a){a.$$hashKey=void 0;var c={};c.id=b.mwrLink.id,c.lifeCycle={},c.lifeCycle.revisionFlags=[],c.lifeCycle.revisionFlags.push(a),h.set(b.dbIndex,c,function(c,d){c||b.tableModel.map(function(b){b.revisionState.id===a.revisionState.id&&(b.required=a.required,b.plan=a.plan,b.actual=a.actual,b.planner=a.planner,b.comment=a.comment)})})},function(){})},b.status=j.processing(),h.getRevisionStates(b.dbIndex,function(a){b.revisionStates=a,m.revisionStatesLoaded=!0,l=m.getInitStatus(),l&&(k.setStatus(j.success()),n())}),h.getRevisionTypes(b.dbIndex,function(a){b.revisionTypes=a,m.revisionTypesLoaded=!0,l=m.getInitStatus(),l&&(k.setStatus(j.success()),n())});var p={siteLinkId:{low:b.siteLinkIdLow,high:b.siteLinkIdHigh},mwrLinkId:b.mwrLinkId,revision:b.revision,variant:0};g.get(b.dbIndex,p,function(a,c){a?b.status=j.failed(a):(b.mwrLink=c,m.mwrLinkLoaded=!0,l=m.getInitStatus(),l&&(k.setStatus(j.success()),n()))})}]})}]),htRevisionStatus.controller("ModifyCtrl",["$scope","$uibModalInstance","selectedRow",function(a,b,c){a.selectedRow=c,a.ok=function(){b.close(a.selectedRow)},a.cancel=function(){b.dismiss("cancel")}}]),htRevisionStatus.factory("$mwrLink",["$http",function(a){"use strict";var b=function(a){var b="mwrlinkrevisionvariant",c="/db/"+a+"/"+b+"/_search";return c},c={};return c.get=function(c,d,e){var f={from:0,size:1,query:{filtered:{query:{match_all:{}},filter:{and:[{term:{mwrLinkId:d.mwrLinkId}},{term:{revision:d.revision}},{term:{variant:d.variant}}]}}}},g={method:"POST",url:b(c),headers:{"Content-Type":"application/json"},data:f};a(g).success(function(a){return 0===a.hits.total?e("Nothing found in DB ;(",null):e(null,a.hits.hits[0]._source)}).error(function(a,b){return e(b,null)})},c}]),htRevisionStatus.factory("$revisionStatus",["$http",function(a){"use strict";var b=function(a,b){var c="/db/"+a+"/"+b+"/_search";return c},c={},d={},e=function(c,d){var e={from:0,size:1,query:{match_all:{}}},f={method:"POST",url:b(c,"mwr_link_revision_states"),headers:{"Content-Type":"application/json"},data:e};a(f).success(function(a){return d(null,a.hits.hits)}).error(function(a,b){return d(b,null)})},f=function(c,d){var e={from:0,size:99,query:{match_all:{}}},f={method:"POST",url:b(c,"mwr_link_revision_type"),headers:{"Content-Type":"application/json"},data:e};a(f).success(function(a){return d(null,a.hits.hits)}).error(function(a,b){return d(b,null)})},g={};return g.getRevisionStates=function(a,b){return void 0!==c[a]?b(c[a]):void e(a,function(c,d){return d[a]=d[0]._source.states,b(d[a])})},g.getRevisionTypes=function(a,b){return void 0!==d[a]?b(d[a]):void f(a,function(c,e){return d[a]=[],e.map(function(b){d[a].push(b._source)}),b(d[a])})},g.set=function(b,c,d){var e={method:"POST",url:"/api/set/mwrlinkrevisionvariant",headers:{"Content-Type":"application/json"},data:c};a(e).success(function(a){return d(null,a)}).error(function(a,b){return d(b,null)})},g}]);var htPathDetails=angular.module("htPathDetails",["ui.bootstrap","alert"]);htPathDetails.config(["$stateProvider",function(a){"use strict";a.state("htPathDetails",{url:"/paths/:dbIndex/:id",templateUrl:"modules/pathDetails/pathDetails.html",controller:["$rootScope","$scope","$stateParams","$pathDetails","authenticationService","alertService","$header",function(a,b,c,d,e,f,g){f.setMessage(["LOADING","SUCCESS","FAILED"]),b.dbIndex=c.dbIndex,b.pathId=c.id,a.title="("+b.pathId+") htPath",b.oneAtATime=!0,b.groups=[{labelId:"INFO",templateUrl:"/ux/modules/pathDetails/templates/info.html",open:!0},{labelId:"RAW_DATA",templateUrl:"/ux/modules/pathDetails/templates/rawData.html",open:!1}],b.path={model:{},get:function(a,c,e){g.setStatus(f.processing()),d.getPath(a,c,function(a){return g.setStatus(f.success()),b.path.model=a._source,e(b.path.model)})},getPrevious:function(a,b,c){d.getPreviousPath(a,b,function(a){return void 0===a?c():c(a._source.id)})},getNext:function(a,b,c){d.getNextPath(a,b,function(a){return void 0===a?c():c(a._source.id)})}};var h=function(a){var c={link:["/ux","#","paths",b.dbIndex,a].join("/"),title:a,active:void 0!==a};return a||(c.link=["/ux","#",""].join("/"),c.title="HOME"),c},i=function(){b.path.get(b.dbIndex,b.pathId,function(a){}),b.path.getPrevious(b.dbIndex,b.pathId,function(a){b.path.previous=a,g.setPrevious(h(a))}),b.path.getNext(b.dbIndex,b.pathId,function(a){b.path.next=a,g.setNext(h(a))})};i()}]})}]),htPathDetails.factory("$pathDetails",["$http",function(a){var b=function(a,b,c){return{method:a,url:b,headers:{"Content-Type":"application/json"},data:c}},c=function(c,d,e,f){var g=Object.keys(e)[0],h="asc";e[g].lt&&(h="desc");var i=["/db",c,"path","_search"].join("/"),j={from:0,size:1,sort:[{id:{order:h}}],_source:{include:[g]},query:{constant_score:{filter:{range:e}}}},k=b("POST",i,j);a(k).success(function(a,b){return f(a.hits.hits[0])}).error(function(a,b){return console.info("htLog: Request for path failed.",JSON.stringify(k),a,b),f([])})},d={};return d.getPath=function(e,f,g){var h=["/db",e,"path","_search"].join("/"),i={from:0,size:1,query:{match:{id:f}}},j=b("POST",h,i);a(j).success(function(a,b){return g(a.hits.hits[0])}).error(function(a,b){return console.info("htLog: Request for path failed.",JSON.stringify(j),a,b),g([])}),d.getPreviousPath=function(a,b,d){var e={id:{lt:b}};c(a,b,e,function(a){return d(a)})},d.getNextPath=function(a,b,d){var e={id:{gt:b}};c(a,b,e,function(a){return d(a)})}},d}]);var htPathManager=angular.module("htPathManager",["ngTouch","ui.bootstrap","ui.grid","ui.grid.exporter","ui.grid.moveColumns","ui.grid.pinning","ui.grid.selection","ui.grid.resizeColumns","htLogin","htDatabase","alert","translate"]);htPathManager.config(["$stateProvider",function(a){"use strict";a.state("pathManager",{url:"/pathManager/:dbIndex",templateUrl:"/ux/modules/pathManager/pathManager.html",controller:["$rootScope","$scope","$stateParams","uiGridConstants","$pathManager","$header","alertService",function(a,b,c,d,e,f,g){b.dbIndex=c.dbIndex,a.title="htPathManager",g.setMessage(["LOADING","SUCCESS","FAILED"]);var h=0,i=1e3,j=0,k=['<a class="vCenter text-right" >','<span title="{{grid.appScope.getTitle(row.entity, 1)}}" ng-click="grid.appScope.show(row.entity)" class="pointer glyphicon glyphicon-map-marker"></span>',"<span> </span>",'<span title="{{grid.appScope.getTitle(row.entity, 2)}}" ng-click="grid.appScope.open(row.entity)" class="pointer glyphicon glyphicon-info-sign"></span>',"</a>"].join("");b.highlightFilteredHeader=function(a,b,c){return c.filters[0].term?"header-filtered":""};var l=["Delete","Show in network map","Show details"];b.getTitle=function(a,b){var c=l[b]+": "+a.id;return c},b.show=function(a){var c="/ux/modules/networkMap/map.html#/"+b.dbIndex+"?path="+a.id;window.open(c,"htNetworkMap")},b.open=function(a){var c="/ux/#/paths/"+b.dbIndex+"/"+a.id;window.open(c,"htSolutions")},b.gridOptions={},b.gridOptions.data=[],b.gridOptions.enableColumnResizing=!0,b.gridOptions.enableSorting=!0,b.gridOptions.enableFiltering=!0,b.gridOptions.enableGridMenu=!0,b.gridOptions.showGridFooter=!0,b.gridOptions.fastWatch=!0,b.gridOptions.enableRowSelection=!0,b.gridOptions.enableRowHeaderSelection=!0,b.gridOptions.multiSelect=!1,b.gridOptions.gridMenuCustomItems=[{title:"Rotate Grid",action:function(a){this.grid.element.toggleClass("rotated")},order:210}],b.gridOptions.columnDefs=[{field:"id",type:"string",headerCellClass:b.highlightFilteredHeader,width:80,pinnedLeft:!0},{field:"status",type:"string",width:120,headerCellClass:b.highlightFilteredHeader},{field:"type",type:"string",width:80,headerCellClass:b.highlightFilteredHeader},{field:"startNetworkElement",displayName:"Start NE",width:100,type:"string",headerCellClass:b.highlightFilteredHeader},{field:"endNetworkElement",displayName:"End NE",width:100,type:"string",headerCellClass:b.highlightFilteredHeader},{field:"planner",displayName:"Planner",type:"string",width:70,headerCellClass:b.highlightFilteredHeader},{field:"countE1",displayName:"E1 count",type:"number",width:70,headerCellClass:b.highlightFilteredHeader,cellClass:"number"},{field:"countSegments",displayName:"Segments count",type:"number",width:80,headerCellClass:b.highlightFilteredHeader,cellClass:"number"},{field:"path",displayName:"Path (Site Ids)",width:600,type:"string",headerCellClass:b.highlightFilteredHeader,enableSorting:!1},{name:"actions",enableSorting:!1,enableFiltering:!1,cellTemplate:k,width:95,pinnedRight:!0,cellClass:"number"}];var m=function(a){return a?a.id.networkElementId:"undefined"},n=function(a){return{id:a._source.id,type:a._source.eType,status:a._source.summaryStatus,startNetworkElement:m(a._source.startNe),endNetworkElement:m(a._source.endNe),planner:a._source.ePlanner.planner,countE1:parseInt(a._source.e1Anzahl),countSegments:a._source.pathSegments.length,path:e.getPath(a).toString().replace(/"/g,"")}},o=function(){var a=h>=j;a||(h+=i,e.getPaths(b.dbIndex,i,h,function(c,d,e){return c?void(a=!0):(e.map(function(a){b.gridOptions.data.push(n(a))}),b.progressbar.value=b.gridOptions.data.length,void(d<=b.gridOptions.data.length&&f.setStatus(g.success())))}),o())},p=function(){f.setStatus(g.processing()),e.getPaths(b.dbIndex,i,h,function(a,c,d){a||(j=c,d.map(function(a){b.gridOptions.data.push(n(a))}),b.progressbar={max:c,value:b.gridOptions.data.length},c<=b.gridOptions.data.length&&f.setStatus(g.success()),o())})};p()}]})}]),htPathManager.factory("$pathManager",["$rootScope","$database",function(a,b){"use strict";var c={};return c.getPaths=function(a,c,d,e){var f,g,h={key:"path"};b.getData(a,h,c,d,f,g,function(a){a&&0!==a.length?e(null,a.hits.total,a.hits.hits):e("Nothing found!",[])})},c.getPath=function(a){if(!a)return[];var b=a._source.pathSegments,c=a._source.startNe.siteRef,d=[];d.push(c);for(var e=0;e<b.length;){var f=b[e].references.siteEndReference.siteId;d.push(f),e+=1}return d},c}]),function(){"use strict";var a=angular.module("htSolutions",["htLogin","htNetworkMap","htSiteLinkDetails","htSiteDetails","htNetworkElementDetails","htPathDetails","htRacklayout","htRevisionStatus","htLinkcalculator","htProfile","htMwrLinkRevision","htEngineer","htMwrLinkManager","htSiteLinkManager","htSiteManager","htPathManager","htBsConnections","htMbhPlanner","htInventory","htSecurity","htServers","htUsers","ui.router","coordinateFilter"]);a.run(["$rootScope","$state","$stateParams",function(a,b,c){a.$state=b,a.$stateParams=c,a.title="htSolutions"}]),a.config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("home",{url:"/",templateUrl:"modules/app/app.html",controller:["$rootScope","$scope","$app","$header","alertService",function(a,b,c,d,e){a.title="htSolutions",d.setStatus(e.clear()),c.getDbIndex(function(a){b.dbIndex=a;var d=c.getNavigation(a);b.managers=d.slice(0,4),b.reports=d.slice(4),b.apps=[{label:"NETWORK_MAP",link:"/ux/modules/networkMap/map.html#/"+b.dbIndex,image:"/ux/modules/networkMap/images/networkMap.png",templateUrl:"/ux/modules/app/templates/default.html",target:"htNetworkMap"},{label:"MANAGEMENT",link:"/ux/#/siteManager/"+b.dbIndex,image:"/ux/modules/app/images/management.png",templateUrl:"/ux/modules/app/templates/management.html",target:"htSiteManager"},{label:"REPORTS",link:"/ux/#/siteManager/"+b.dbIndex,image:"/ux/modules/app/images/reports.png",templateUrl:"/ux/modules/app/templates/reports.html",target:"htBsPath"},{label:"LINK_CALCULATOR",link:"/ux/#/linkcalculator/sandbox/0/0/0/0/0",image:"/ux/modules/linkcalculator/images/linkcalculator.png",templateUrl:"/ux/modules/app/templates/default.html",target:"htSolutions"},{label:"LINK_ENGINEER",link:"/ux/#/engineer/"+b.dbIndex+"/0/0",image:"/ux/modules/engineer/images/linkEngineer.png",templateUrl:"/ux/modules/app/templates/default.html",target:"htSolutions"},{label:"INVENTORY",link:"/ux/#/inventory/"+b.dbIndex,image:"/ux/modules/inventory/images/inventory.png",templateUrl:"/ux/modules/app/templates/default.html",target:"htSolutions"}],b.utilities=[{label:"PROFILE",link:"/ux/#/profile",icon:"fa fa-user",target:"htSolutions"},{label:"USERS",icon:"fa fa-users",link:"/ux/#/users",target:"htSolutions"},{label:"SECURITY",icon:"fa fa-lock",link:"/ux/#/security",target:"htSolutions"},{label:"SERVERS",icon:"fa fa-server",link:"/ux/#/servers",target:"htSolutions"},{label:"API_DOCUMENTATION",icon:"fa fa-question",link:"/ux/swagger/index.html",target:"htSolutions"},{label:"DATABASE",
link:"/ux/#/database/"+b.dbIndex,icon:"fa fa-database",target:"htDatabase"}]})}]}).state("about",{url:"/about",templateProvider:["$timeout",function(a){return a(function(){return'<p class="lead">About box </p>'},100)}]})}])}(),app.factory("$app",["$http",function(a){"use strict";var b=function(a,b){return{method:a,url:b,headers:{"Content-Type":"application/json"}}},c={};return c.dbIndex="unknown",c.getDbIndex=function(d){var e="/api/server",f=b("GET",e);a(f).success(function(a){return c.dbIndex=a.network_index,d(c.dbIndex)}).error(function(a,b){return d(c.dbIndex)})},c.getNavigation=function(a){var b=[{label:"SITE_MANAGER",link:"/ux/#/siteManager/"+a,target:"htSiteManager"},{label:"SITELINK_MANAGER",link:"/ux/#/siteLinkManager/"+a,target:"htSiteLinkManager"},{label:"MWRLINK_MANAGER",link:"/ux/#/mwrLinkManager/"+a,target:"htMwrLinkManager"},{label:"PATH_MANAGER",link:"/ux/#/pathManager/"+a,target:"htPathManager"},{label:"BS_CONNECTIONS",link:"/ux/#/bsConnections/"+a,target:"htBsConnections"}];return b},c}]);